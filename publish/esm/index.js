import e,{useRef as t}from"react";const r=(e,t=!1,r)=>{let n=[];if(n=Array.isArray(e)?2===e.length?[e[1],e[0],e[1],e[0]]:[...e]:[e,e,e,e],t&&(n=[n[1],n[0],n[3],n[2]]),r){const e=[];for(let t=0;r>t;t++)e.push(n[t%4]);n=e}return n},n=({className:t,children:n,style:o,root:l,threshold:i,rootMargin:s,visibleContent:c=!1,onIntersection:a})=>{const[u,d]=e.useState(!1),m=e.useRef(null),f=e.useMemo((()=>{if(!s)return"";const e=r(s);return`${e[0]}px ${e[1]}px ${e[2]}px ${e[3]}px`}),[s]),p=e.useCallback((([e])=>{d(e.isIntersecting),a&&a({time:e.time,rootBounds:e.rootBounds,boundingClientRect:e.boundingClientRect,intersectionRect:e.intersectionRect,isIntersecting:e.isIntersecting,intersectionRatio:e.intersectionRatio,target:e.target})}),[a]);return e.useEffect((()=>{const e=new IntersectionObserver(p,{root:l,threshold:i,rootMargin:f});return m.current&&e.observe(m.current),()=>{e.disconnect()}}),[p,l,i,f]),e.createElement("div",{"intersection-tracker":"",className:t,ref:m,style:o},c||u?n:null)};n.displayName="IntersectionTracker";const o=({className:t,children:r,style:n,measure:o="inner",onResize:l})=>{const i=e.useRef(null);e.useEffect((()=>{const e=i.current;if(!e)return;const t=new ResizeObserver((e=>{for(const t of e)l&&l(t.contentRect)}));return t.observe(e),()=>{t.unobserve(e),t.disconnect()}}),[o,l]);const s={width:"max-content",height:"max-content"},c={inner:Object.assign({},s),outer:Object.assign({},{width:"100%",height:"100%"}),all:Object.assign({minWidth:"100%",minHeight:"100%"},s)};return e.createElement("div",{"resize-tracker":"",className:t,ref:i,style:Object.assign(Object.assign({willChange:"width, height"},c[o]),n)},r)};o.displayName="ResizeTracker";let l=1;const i=({type:t,direction:r,progressReverse:n,size:o,progressTrigger:l,scrollBarOnHover:i,scrollBarEvent:s,thumbSize:c,thumbSpace:a,objLengthPerSize:u,sliderCheckLocal:d,duration:m})=>{const f=e.useRef(null),p=e.useRef(null);e.useEffect((()=>{if(matchMedia("(pointer: coarse)").matches||!(null==l?void 0:l.wheel))return;const e=f.current;if(!e)return;const t="y"===e.getAttribute("data-direction")?"y":"x";let r=e.previousElementSibling;for(;r&&!r.classList.contains("ms-element");)r=r.previousElementSibling;const n=e=>{e.preventDefault(),null==r||r.scrollBy(Object.assign(Object.assign({},"y"===t?{top:e.deltaY}:{left:e.deltaY}),{behavior:"auto"}))};return e.addEventListener("wheel",n,{passive:!1}),()=>e.removeEventListener("wheel",n)}),[]),e.useEffect((()=>{const e=p.current;if(!e||"sliderMenu"===t)return;const r=window.matchMedia("(pointer: coarse)").matches?"touchstart":"mousedown",n=e=>{e.preventDefault(),e.stopPropagation(),s(e)};return e.addEventListener(r,n,{passive:!1}),()=>{e.removeEventListener(r,n)}}),[s]);const h=e.useMemo((()=>{if("scroll"===t||!r)return;const n=["hybrid","y"].includes(r)?"y":"x",i="x"===n?o[0]:o[1];return Array.from({length:u},((r,o)=>e.createElement("div",{key:o,className:"ms-slider-element",style:Object.assign({},"sliderMenu"===t&&{cursor:"pointer"}),onClick:"sliderMenu"===t?()=>{s(i*o,n,m,d)}:void 0},Array.isArray(null==l?void 0:l.progressElement)?l.progressElement[o]:null==l?void 0:l.progressElement)))}),[u,r,o,t,s,null==l?void 0:l.progressElement,m,d]);return e.createElement(e.Fragment,null,"scroll"===t?e.createElement("div",{className:"ms-bar",ref:f,"data-direction":["hybrid","y"].includes(r)?"y":"x",style:Object.assign(Object.assign(Object.assign({position:"absolute",width:"fit-content"},"x"===r?Object.assign({transformOrigin:"left top",height:o[0]+"px",left:"50%"},n?{top:0,transform:"rotate(-90deg) translate(-100%, -50%)"}:{transform:"rotate(-90deg) translateY(-50%)"}):Object.assign({top:"50%",transform:"translateY(-50%)",height:o[1]+"px"},n?{left:0}:{right:0})),0!=!(null==l?void 0:l.progressElement)&&{pointerEvents:"none"}),i&&{opacity:0,transition:"opacity 0.1s ease-in-out"})},e.createElement("div",{className:"ms-thumb",ref:p,style:Object.assign(Object.assign({height:c+"px",willChange:"transform, height",transform:`translateY(${a}px)`},(null==l?void 0:l.progressElement)&&{cursor:"grab"}),{transition:"height 0.05s ease-in-out"})},null==l?void 0:l.progressElement)):u>1&&(null==l?void 0:l.progressElement)&&e.createElement("div",{className:"ms-slider",ref:p,style:Object.assign(Object.assign(Object.assign({position:"absolute",display:"flex"},"slider"===t&&{cursor:"grab"}),i&&{opacity:0,transition:"opacity 0.1s ease-in-out"}),"x"===r?Object.assign({transformOrigin:"left top",left:"50%",transform:"translateX(-50%)"},n?{top:0}:{bottom:0}):Object.assign({flexDirection:"column",top:"50%",transform:"translateY(-50%)"},n?{left:0}:{right:0}))},h))};i.displayName="ScrollBar";var s=e.memo(i);const c=({edgeGradient:t,visibility:r,edgeType:n})=>{if(!t)return null;const o=Object.assign(Object.assign(Object.assign(Object.assign({position:"absolute",pointerEvents:"none",transition:"opacity 0.1s ease-in-out"},t.color&&{background:t.color&&`linear-gradient(${"right"===n||"left"===n?"270deg, ":""}${t.color}, transparent)`}),"right"===n||"left"===n?{height:"100%",width:t.size+"px",top:0}:{width:"100%",height:t.size+"px",left:0}),n?{[n]:0}:{}),"left"===n?{transform:"scaleX(-1)"}:"bottom"===n?{transform:"scaleY(-1)"}:{});return e.createElement("div",{className:"ms-edge"+(n?" "+n:""),style:Object.assign(Object.assign({},o),{opacity:r?1:0})})};c.displayName="Edge";var a=e.memo(c);const u=({activity:t,arrows:r,arrowType:n,handleArrow:o,size:l})=>{const i=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({position:"absolute",display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer",width:r.size+"px"},n?{[n]:0}:{}),"top"===n&&{transform:"rotate(-90deg) translateX(-100%)",transformOrigin:"left top"}),"bottom"===n&&{transform:"rotate(90deg) translateX(-100%)",transformOrigin:"left bottom"}),"left"===n&&{transform:"scaleX(-1)"}),["top","bottom"].includes(n)?{height:l+"px"}:{height:"100%",top:0});return e.createElement("div",{className:`ms-arrow-box ${n}${t?" active":""}`,style:Object.assign({},i),onClick:()=>o(n)},r.element)};u.displayName="Arrow";var d=e.memo(u);function m(e,t,r,n){return new(r||(r=Promise))((function(o,l){function i(e){try{c(n.next(e))}catch(e){l(e)}}function s(e){try{c(n.throw(e))}catch(e){l(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,s)}c((n=n.apply(e,t||[])).next())}))}"function"==typeof SuppressedError&&SuppressedError;let f=0;const p={tasks:[],timer:null,running:new Set},h=new Map,g={scheduleNext(){if(null!==p.timer&&(clearTimeout(p.timer),p.timer=null),0===p.tasks.length)return;const e=p.tasks[0],t=Math.max(0,e.runAt-performance.now());p.timer=window.setTimeout((()=>{p.timer=null;const e=performance.now(),t=[];for(;p.tasks.length&&p.tasks[0].runAt<=e&&!p.running.has(p.tasks[0].id);)t.push(p.tasks.shift());t.forEach((e=>{p.running.add(e.id);try{e.callback()}finally{p.running.delete(e.id)}})),g.scheduleNext()}),t)},clearAll(){null!==p.timer&&(clearTimeout(p.timer),p.timer=null),p.tasks=[],p.running.clear()}},y=(e,t,r,n)=>{const o=r||"task_"+f++;if(0===t)return e(),o;const l=n||"default",i=performance.now()+t;if("exclusive"===l){if(p.running.has(o)||p.tasks.some((e=>e.id===o)))return o;p.running.add(o);try{e()}finally{const e=window.setTimeout((()=>{p.running.delete(o),h.delete(o)}),t);h.set(o,e)}return o}r&&(p.tasks=p.tasks.filter((e=>e.id!==o)));const s={id:o,runAt:i,callback:()=>{p.running.add(o);try{e()}finally{p.running.delete(o)}}};return function(e,t){let r=0,n=e.length;for(;n>r;){const o=r+n>>1;e[o].runAt<t.runAt?r=o+1:n=o}e.splice(r,0,t)}(p.tasks,s),g.scheduleNext(),o},b=e=>{if(!e)return g.clearAll(),h.forEach((e=>clearTimeout(e))),void h.clear();(Array.isArray(e)?e:[e]).forEach((e=>{p.running.delete(e);const t=h.get(e);void 0!==t&&(clearTimeout(t),h.delete(e)),p.tasks=p.tasks.filter((t=>t.id!==e)),0===p.tasks.length?g.clearAll():g.scheduleNext()}))};function v(e,t){return e>t?Math.floor(e/t):1}function x(e,t=0,r=1/0){return Math.max(t,Math.min(Math.round(e),r))}const E=(e,t,r)=>{if(!t)return;const n=t.querySelectorAll("."+("scroll"===e?"ms-thumb":"ms-slider"));n.length>0&&(r.current=n)},w=e=>e?"start"===e?"flex-start":"center"===e?"center":"flex-end":void 0;function j(e,t,r=0,n=0){return o=>{var l,i,s,c;let a=!1;const u={width:(null!==(l=o.width)&&void 0!==l?l:0)-r,height:(null!==(i=o.height)&&void 0!==i?i:0)-n},d=0===u.width&&0===u.height;d&&!a&&(a=!0),(null===(s=e.current)||void 0===s?void 0:s.width)===u.width&&(null===(c=e.current)||void 0===c?void 0:c.height)===u.height||d&&a||(e.current=u,t())}}function S(t){const r=[],n=t=>{if(null===t||"number"==typeof t||"boolean"==typeof t||"bigint"==typeof t)r.push(t+"");else if("string"==typeof t)r.push(t);else if("function"==typeof t)r.push("<function>");else if(e.isValidElement(t))r.push("<react-node>");else if(Array.isArray(t))t.forEach(n);else if("object"==typeof t){const e=Object.entries(t).sort((([e],[t])=>e.localeCompare(t)));for(const[,t]of e)n(t)}else void 0===t&&r.push("<undefined>")};return n(t),r.join("/")}const R="wrap-id",M=(e,t)=>{if(e)if("grab"===e.style.cursor){if("mousedown"===t){const e=document.createElement("style");e.id="ms-cursor-lock",e.innerHTML="* {\n        cursor: grabbing !important;\n      }",document.head.appendChild(e)}e.style.cursor="grabbing",e.classList.add("active")}else if("grabbing"===e.style.cursor){if("mousedown"===t){const e=document.getElementById("ms-cursor-lock");e&&e.remove()}e.style.cursor="grab",e.classList.remove("active")}},k=(e,t,r,n)=>{const o=e;["thumb","slider"].includes(t)?M("slider"===t?null==r?void 0:r.closest(".ms-slider"):r,o):"wrapp"===t&&M(n,o)},O=(e,t,r)=>{var n,o,l,i,s;const c=r.scrollElementRef;if(!c)return;const a={x:"touches"in r.mouseEvent?r.mouseEvent.touches[0].clientX:r.mouseEvent.clientX,y:"touches"in r.mouseEvent?r.mouseEvent.touches[0].clientY:r.mouseEvent.clientY,leftover:null!==(o=null===(n=r.prevCoordsRef.current)||void 0===n?void 0:n.leftover)&&void 0!==o?o:0},u=null!==(l=r.prevCoordsRef.current)&&void 0!==l?l:a,d={x:a.x-u.x,y:a.y-u.y};r.prevCoordsRef.current=a;const m="wrapp"===r.clicked?-d[e]:d[e],f="y"===e?"scrollTop":"scrollLeft";if("thumb"===r.clicked)return void((e,t,r,n,o)=>{if(!t.scrollElementRef||!t.objectsWrapperRef)return;const l=t.scrollElementRef,i="x"===e?0:1;if(!Number.isFinite(o[i]))return;const s=t.objectsWrapperWH[i]+t["x"===e?"fullMarginX":"fullMarginY"],c=(t.scrollElementWH[i]-t.scrollBarEdge[i]-t.thumbSize)*o[i],a=s-t.scrollElementWH[i];if(0>=c||0>=a)return;const u=r*(a/c)+n.leftover,d=Math.trunc(u);if(t.prevCoordsRef.current&&(t.prevCoordsRef.current.leftover=u-d),"x"===e){const e="number"==typeof t.scrollStateRef.targetScrollX?t.scrollStateRef.targetScrollX:l.scrollLeft,r=l.scrollWidth-l.clientWidth;t.scrollStateRef.targetScrollX=x(e+d,0,r)}else{const e="number"==typeof t.scrollStateRef.targetScrollY?t.scrollStateRef.targetScrollY:l.scrollTop,r=l.scrollHeight-l.clientHeight;t.scrollStateRef.targetScrollY=x(e+d,0,r)}l.scrollLeft!==t.scrollStateRef.targetScrollX&&(l.scrollLeft=t.scrollStateRef.targetScrollX),l.scrollTop!==t.scrollStateRef.targetScrollY&&(l.scrollTop=t.scrollStateRef.targetScrollY)})(e,r,m,u,t);"slider"===r.type&&(r.numForSliderRef.current+=m);const p="x"===e?0:1;if("wrapp"===r.clicked){if(!Number.isFinite(t[p]))return;return void(c[f]+=m/t[p])}const h=c[f],g=Math.round((null===(s=null===(i=c.closest(".ms-content"))||void 0===i?void 0:i.querySelector(".ms-slider-element.active"))||void 0===s?void 0:s.getBoundingClientRect()["x"===e?"width":"height"])||1);if(Math.abs(r.numForSliderRef.current)>=g){const t=m>0&&h+r.sizeLocal[p]<r.wrapElWH[p]?h+r.sizeLocal[p]:0>m&&h>0?h-r.sizeLocal[p]:null;r.numForSliderRef.current=0,r.smoothScroll(t,e,10)}};function A(e){e.rafID.current&&(cancelAnimationFrame(e.rafID.current),e.rafID.current=NaN,b("smoothScrollBlock"));const t=e.scrollElementRef;t&&(e.scrollStateRef.targetScrollX=t.scrollLeft,e.scrollStateRef.targetScrollY=t.scrollTop);let r=0,n=0,o=[],l=[],i=[],s=[];if("thumb"===e.clicked){const t=getComputedStyle(e.objectsWrapperRef),i=e=>{const r=e=>parseFloat(e);return"x"===e?r(t.marginLeft)+r(t.marginRight):r(t.marginTop)+r(t.marginBottom)};r=i("x"),n=i("y"),o=[e.scrollElementRef.clientWidth,e.scrollElementRef.clientHeight],l=[e.objectsWrapperRef.clientWidth,e.objectsWrapperRef.clientHeight]}"slider"===e.type&&(i=[e.objectsWrapperRef.clientWidth,e.objectsWrapperRef.clientHeight]),["scroll","slider"].includes(e.type)&&(s=function(e){const t=e.getBoundingClientRect();return[t.width/e.clientWidth,t.height/e.clientHeight]}(e.scrollElementRef));const c=new AbortController,{signal:a}=c;e.clickedObject.current=e.clicked,e.triggerUpdate();k(e.eventType,e.clicked,e.scrollBar,e.objectsWrapperRef),document.addEventListener("pointermove",(t=>{return"touches"in(c=t)&&c.preventDefault(),void function(e){const t=e.direction||"y";"hybrid"===t?("wrapp"===e.clicked?["x","y"]:[e.axisFromAtr]).forEach((t=>t&&O(t,e.visualDiff,e))):O(t,e.visualDiff,e)}(Object.assign(Object.assign({},e),{mouseEvent:c,fullMarginX:r,fullMarginY:n,scrollElementWH:o,objectsWrapperWH:l,wrapElWH:i,visualDiff:s}));var c}),{passive:!1,signal:a}),document.addEventListener("pointerup",(t=>function(e){if(e.controller.abort(),k(e.eventType,e.clicked,e.scrollBar,e.objectsWrapperRef),e.clickedObject.current="none",e.scrollBarOnHover){let t=e.mouseEvent.target,r=!1;for(;t&&t!==document.body;){if(t===e.scrollContentRef){r=!0;break}t=t.parentNode}r||e.mouseOnRefHandle(e.mouseEvent)}if("slider"===e.type){const t=e.scrollElementRef;if(!t)return;const r=e.numForSliderRef.current,n="y"===e.direction?"scrollTop":"scrollLeft",o="y"===e.direction?t.clientHeight:t.clientWidth,l=e=>o*Math[e](t[n]/o);if(Math.abs(r)>20){const t=l(r>0?"ceil":"floor");e.smoothScroll(t,"y"===e.direction?"y":"x",e.duration)}else{const t=l(r>0?"floor":"ceil");e.smoothScroll(t,"y"===e.direction?"y":"x",e.duration)}e.numForSliderRef.current=0}e.prevCoordsRef.current=null,e.triggerUpdate()}(Object.assign(Object.assign({},e),{mouseEvent:t,controller:c}))),{signal:a})}function L(e,t,r){return t?x(Math.round(e/t*e),r,e):0}function z(e,t,r,n){return t?x(e/t*(r-n),0,r-n):0}const T=({className:n,children:i,type:c="scroll",direction:u="y",scrollPosition:f,onScrollValue:p,isScrolling:h,size:g,objectsSize:M,crossCount:k,gap:O,wrapperMargin:T,wrapperMinSize:C,wrapperAlign:N,elementsAlign:F,elementsDirection:W="row",edgeGradient:I,progressTrigger:H={wheel:!0},progressReverse:B=!1,scrollBarOnHover:Y=!1,scrollBarEdge:X,thumbMinSize:D,render:$,emptyElements:P,suspending:q=!1,fallback:K})=>{var V,U,_,G,J;const Q=function(){const e=t(null);return null===e.current&&(e.current=""+l++),e.current}();if(!g)throw Error('Prop "size" is not provided\nmorph-scroll '+Q);Object.keys(H).length;const[,Z]=e.useState({}),ee=()=>Z({}),te=e.useRef(null),re=e.useRef(null),ne=e.useRef(null),oe=e.useRef(null),le=e.useRef([]),ie=e.useRef(null),se=e.useRef(!0),ce=e.useRef("none"),ae=e.useRef({loaded:[],empty:[]}),ue=e.useRef({targetScrollY:0,targetScrollX:0,animating:!1,animationFrameId:0}),de=e.useRef(!1),me=e.useRef(0),fe=e.useRef(null),pe=e.useRef(!1),he=e.useRef(NaN);function ge(){return e.useRef({width:0,height:0})}const ye=ge(),be=ge(),ve=ge(),[xe,Ee,we,je,Se,Re,Me,ke,Oe,Ae,Le]=function(...e){return e.map(S)}(f,$,g,M,P,C,N,O,H,ae.current.empty,X),ze=e.useMemo((()=>{var e,t;let r=[null],n=200,o=null;if(null!=f)if("number"==typeof f||"end"===f)r=[f,f];else if(Array.isArray(f))r=f;else if("object"==typeof f){const l=f.value;"number"==typeof l||"end"===l?r=[l,l]:Array.isArray(l)&&(r=l),n=null!==(e=f.duration)&&void 0!==e?e:200,o=null!==(t=f.updater)&&void 0!==t?t:null}return{value:r,duration:n,updater:o}}),[xe]),Te={color:null,size:40},Ce=e.useMemo((()=>"object"==typeof I?Object.assign(Object.assign({},Te),I):"string"==typeof I?{color:I,size:40}:Te),[I]),Ne=e.useMemo((()=>{const t=H.arrows,r={size:40,contentReduce:!0,loop:!1};return e.isValidElement(t)?Object.assign(Object.assign({},r),{element:t}):"object"==typeof t&&null!==t?Object.assign(Object.assign({},r),t):r}),[Oe]),Fe=e.useCallback((t=>{if(null==t)return[];if(e.isValidElement(t)){const r=t;return r.type===e.Fragment?e.Children.toArray(r.props.children).flatMap(Fe):[r]}return[t]}),[]),We=e.useMemo((()=>e.Children.toArray(i).flatMap(Fe).map((t=>e.isValidElement(t)&&t.key?t.key+"":null)).filter((e=>null!==e)).filter((e=>{var t;return"clear"!==(null==P?void 0:P.mode)||!(null===(t=ae.current.empty)||void 0===t?void 0:t.includes(e))}))),[i,Fe,Se,Ae]),[Ie,He,Be,Ye]=T?r(T):[0,0,0,0],Xe=Ie+Be,De=Ye+He,[$e,Pe]=e.useMemo((()=>{var e,t;return"number"==typeof O?[O,O]:Array.isArray(O)?[null!==(e=O[1])&&void 0!==e?e:0,null!==(t=O[0])&&void 0!==t?t:0]:[0,0]}),[O]),qe=e.useMemo((()=>{const e={type:void 0,rootMargin:0,stopLoadOnScroll:!1};if("string"==typeof $)return Object.assign(Object.assign({},e),{type:$});if("object"==typeof $&&null!==$){const{type:e,rootMargin:t=0,stopLoadOnScroll:r=!1}=$;return{type:e,rootMargin:t,stopLoadOnScroll:r}}return e}),[Ee]),Ke=e.useMemo((()=>r(qe.rootMargin,"x"===u)),[qe.rootMargin,u]),[Ve,Ue]=Ke?[Ke[2],Ke[0]]:[0,0],_e=e.useMemo((()=>{const[e,t]=Array.isArray(g)?g:"number"==typeof g?[g,g]:[ye.current.width,ye.current.height];if(!H.arrows||!Ne.size||!Ne.contentReduce)return[e,t,e,t];const r=2*Ne.size;let n=e,o=t;return"x"===u?n=e-r:"y"===u?o=t-r:"hybrid"===u&&(n=e-r,o=t-r),[n,o,e,t]}),[we,Oe,u,Ne,ye.current.height,ye.current.width]),Ge="x"===u?_e[0]:_e[1],Je=e.useMemo((()=>{if(!X)return[0,0];if("number"==typeof X){const e=2*X;return[e,e]}if(Array.isArray(X)){const[e=0,t]=X;return[2*e,2*(null!=t?t:e)]}return[0,0]}),[Le]),Qe="x"===u?Je[0]:Je[1],Ze=e.useMemo((()=>[_e[0]-Je[0],_e[1]-Je[1]]),[Je.join(),_e[0],_e[1]]),et="x"===u?Ze[0]:Ze[1],tt=e.useMemo((()=>M?Array.isArray(M)?M:r(M,!0,2):[null,null]),[je]),rt=e.useMemo((()=>{const e=(e,t)=>"number"==typeof e?e:"firstChild"===e?t:0;return[e(tt[0]&&"none"!==tt[0]&&"size"!==tt[0]?tt[0]:"y"===u&&"none"!==tt[0]||"size"===tt[0]?_e[0]:0,ve.current.width),e(tt[1]&&"none"!==tt[1]&&"size"!==tt[1]?tt[1]:"x"===u&&"none"!==tt[1]||"size"===tt[1]?_e[1]:0,ve.current.height)]}),[tt.join(),u,ve.current.width,ve.current.height,_e.join()]),nt=e.useMemo((()=>{const e="x"===u,t="row"===W,r="column"===W,n=e?_e[1]:_e[0],o=e?rt[1]+Pe:rt[0]+$e,l="hybrid"===u?o*(We.length+1)-o:n,i=Math.floor(l/o)||1,s=k&&i>=k?"hybrid"===u?Math.ceil(i/k):k:i,c=s>1&&s<We.length?Math.ceil(We.length/s):s>We.length?1:We.length,a=k&&k<We.length,d=e=>Number.isFinite(e)&&e>0?e:1;if("hybrid"===u){const e=a?t?k:s:t?We.length:1,n=a?r?k:s:r?We.length:1;return[d(e),d(n)]}return[d(s),d(c)]}),[W,Pe,$e,rt.join(),We.length,u,_e.join(),k]),ot=e.useMemo((()=>{const e=nt[0]?nt[0]*Pe-Pe:0,t=nt["x"===u?1:0],r=We.length<t?We.length:t;return rt[0]?(rt[0]+Pe)*r-Pe:qe.type?ve.current.width+e:be.current.width}),[u,rt[0],nt.join(),Pe,be.current.width,ve.current.width,qe.type,We.length]),lt=e.useMemo((()=>{const e=1>nt[1]?1:nt[0]*$e-$e;return rt[1]?"x"===u?(rt[1]+$e)*nt[0]-$e:(rt[1]+$e)*nt[1]-$e:qe.type?ve.current.height+e:be.current.height}),[u,rt[1],nt.join(),$e,be.current.height,ve.current.height,qe.type]),it=e.useMemo((()=>lt+Xe),[lt,Xe]),st=e.useMemo((()=>ot+De),[ot,De]),ct="x"===u?st:it,at="x"===u?(null===(V=ne.current)||void 0===V?void 0:V.scrollLeft)||0:(null===(U=ne.current)||void 0===U?void 0:U.scrollTop)||0,ut=at>1&&!0,dt=ct>Math.round(at+Ge);let mt=!1,ft=!1;"hybrid"===u&&(mt=((null===(_=ne.current)||void 0===_?void 0:_.scrollLeft)||0)>1&&!0,ft=Math.round(((null===(G=ne.current)||void 0===G?void 0:G.scrollLeft)||0)+_e[0])<st);const pt=e.useMemo((()=>null!=D?D:30),[D]),ht=e.useCallback((({withLimit:e=!0,xSize:t})=>H.progressElement&&ct?t?L(e?Ze[0]:_e[0],e?st-Je[0]:st,pt):L(e?et:Ge,e?ct-Qe:ct,pt):0),[Oe,ct,et,Qe,Je[0],Ge,_e[0],Ze[0],st,pt]),gt=e.useMemo((()=>Ge?ct-Ge:ct),[ct,Ge]),yt=e.useMemo((()=>_e[0]?st-_e[0]:st),[st,_e[0]]),bt=e.useCallback((()=>{if(!qe.type||1>=nt[0])return[];const e=Array.from({length:We.length},((e,t)=>t)),t=Array.from({length:nt[0]},(()=>[])),r="x"===u&&"column"===W||"x"!==u&&"row"===W;return e.forEach((e=>{const n=r?e%nt[0]:Math.floor(e/nt[1]);t[n]&&t[n].push(e)})),t}),[We.length,nt.join(),qe.type,W,u]),vt=e.useMemo((()=>{if(!qe.type)return[{elementTop:0,elementBottom:0,left:0,right:0}];let e=[],t=0;if(F){const r=Array.from({length:We.length},((e,t)=>t)),n=Math.abs(Math.floor(We.length/nt[0])*nt[0]-We.length);e=n?r.slice(-n):[],"center"===F?t=(rt[0]+Pe)*(nt[0]-n)/2:"end"===F&&(t=(rt[0]+Pe)*(nt[0]-n))}return We.map(((r,n)=>{const o=function(e,t){for(let r=0;r<t.length;r++){const n=t[r].indexOf(e);if(-1!==n)return["x"===u?n:r,["hybrid","y"].includes(u)?n:r]}return[0,0]}(n,bt()),l=e.length>0&&e.includes(n)?t:0,i=function(e){const t="x"===u?l:0;return e>0?t+(rt[1]+$e)*e:t}(nt[0]>1||["hybrid","x"].includes(u)?o[1]:n),s=rt[1]?i+rt[1]:i,c=function(e){const t="x"===u?0:l;return e>0?t+(rt[0]+Pe)*e:t}(1===nt[0]&&"x"===u?n:o[0]);return{elementTop:i,elementBottom:s,left:c,right:c+rt[0]}}))}),[u,nt[0],rt.join(),$e,Pe,qe.type,W,F,bt,We.join()]),xt=e.useMemo((()=>(null==_e?void 0:_e.length)&&N?function(e,t,r,n){const[o,l="start"]="string"==typeof e?[e,e]:e,i={display:"flex"};return t[0]>r&&(i.justifyContent=w(o)),t[1]>n&&(i.alignItems=w(l)),i}(N,_e,st,it):{}),[N,_e.join(),it,st]),Et=e.useMemo((()=>[v(st,_e[0]),v(it,_e[1])]),[st,it,_e.join()]),wt=e.useMemo((()=>"x"===u?Et[0]:Et[1]),[u,Et[0],Et[1]]),jt=e.useCallback(j(ye,ee),[]),St=e.useCallback(j(be,ee,De,Xe),[De,Xe]),Rt=e.useCallback(j(ve,ee),[]),Mt=e.useCallback(((e,t,r)=>{const n=ne.current;return n&&null!==e?function(e,t,r,n,o){return m(this,void 0,void 0,(function*(){if(!t||null==n)return null;const l="y"===e?"scrollTop":"scrollLeft",i=t[l];return i!==n?null===r?(yield function(e){return m(this,void 0,void 0,(function*(){for(;e.scrollHeight<=e.clientHeight&&e.scrollWidth<=e.clientWidth;)yield new Promise((e=>requestAnimationFrame(e)))}))}(t),void(t[l]=n)):void y((()=>{const e=performance.now(),s=()=>{const c=performance.now(),a=r?Math.min((c-e)/r,1):1;t[l]=i+(n-i)*a,1>a&&(o.current=requestAnimationFrame(s))};s()}),r,"smoothScrollBlock","exclusive"):void 0}))}(t,n,se.current?null:r,e,he):null}),[se.current]),kt=e.useCallback(((e,t)=>{if(ie.current){if(ie.current!==We[0])return void(ie.current=We[0])}else ie.current=We[0];Mt(t,e,ze.duration)}),[We[0],ze.duration,Mt]),Ot=e.useMemo((()=>{const e=Object.assign(Object.assign(Object.assign(Object.assign({margin:T?`${Ie}px ${He}px ${Be}px ${Ye}px`:"",height:tt[1]&&"none"!==tt[1]?lt+"px":"fit-content",width:tt[0]&&"none"!==tt[0]?ot+"px":"fit-content"},H.content&&{cursor:"grab"}),O&&!qe.type&&{gap:`${$e}px ${Pe}px`}),C&&function(e,t,r,n,o){const l=(e,t)=>"full"===e?("x"===t?r[0]:r[1])-("x"===t?n:o):e;if("hybrid"!==t&&!Array.isArray(e)){const r=l(e,t)+"px";return"x"===t?{minWidth:r}:{minHeight:r}}let i,s;return Array.isArray(e)?[i,s]=e:i=s=e,{minWidth:l(i,"x")+"px",minHeight:l(s,"y")+"px"}}(C,u,_e,De,Xe)),N&&{flexShrink:0});if(qe.type)return Object.assign(Object.assign({},e),{position:"relative"});const t=tt[1]?"wrap":void 0,r=1===nt[0]?"y"===u?"column":"row":W;return Object.assign(Object.assign({},e),{display:"flex",flexDirection:r,flexWrap:t,justifyContent:w(F)})}),[T,Me,Re,[Ie,He,Be,Ye,De,Xe,$e,Pe].join(),_e.join(),ke,tt[1],lt,ot,H.content,ke,qe.type,u,nt[0],W,F]),At=e.useCallback((e=>{if(!Y)return;const t=()=>((e,t,r)=>{e&&e.querySelectorAll(".ms-bar").forEach((e=>{const t=e;["mouseleave","pointerup"].includes(r.type)?(t.style.opacity="0",t.classList.remove("hover"),t.classList.add("leave"),y((()=>t.classList.remove("leave")),200)):(t.style.opacity="1",t.classList.add("hover"))}))})(re.current,0,e);"mouseleave"===e.type?!["thumb","slider","wrapp"].includes(ce.current)&&t():t()}),[Y]),Lt=e.useCallback(((e,t="mousedown",r)=>{var n;const o=e||("scroll"===c?"thumb":"slider");if("wrapp"===e&&!H.content||["thumb","slider"].includes(o)&&!H.progressElement)return;E(c,te.current,le);let l=null;r&&(l=null===(n=r.closest(".ms-bar"))||void 0===n?void 0:n.getAttribute("data-direction")),A({eventType:t,scrollElementRef:ne.current,objectsWrapperRef:oe.current,scrollBar:r||null,clickedObject:ce,scrollContentRef:re.current,scrollStateRef:ue.current,type:c,scrollBarOnHover:Y,mouseOnRefHandle:At,triggerUpdate:ee,direction:u,smoothScroll:Mt,sizeLocal:[_e[0],_e[1]],clicked:o,numForSliderRef:me,prevCoordsRef:fe,thumbSize:ht("x"===l?{xSize:!0}:{}),axisFromAtr:l,duration:ze.duration,scrollBarEdge:Je,rafID:he})}),[u,c,H.content,H.progressElement,_e.join(),ht({}),ht({xSize:!0}),ze.duration,Mt,At,Y,Je.join()]),zt=e.useCallback((e=>{Lt(null,e.type,e.target)}),[Lt]),Tt=e.useCallback((e=>{ne.current&&(({arrowType:e,scrollElement:t,wrapSize:r,scrollSize:n,smoothScroll:o,duration:l,loop:i})=>{const s=r[0],c=r[1],a=["top","bottom"].includes(e)?c:s,u=t.scrollTop,d=t.scrollLeft,m=t=>{o(t,["top","bottom"].includes(e)?"y":"x",l)};switch(e){case"top":u>0?m(u-n[1]):i&&m(a);break;case"left":d>0?m(d-n[0]):i&&m(a);break;case"right":d+n[0]<s?m(d+n[0]):i&&m(0);break;case"bottom":u+n[1]<c?m(u+n[1]):i&&m(0)}})({arrowType:e,scrollElement:ne.current,wrapSize:[st,it],scrollSize:_e,smoothScroll:Mt,duration:ze.duration,loop:Ne.loop})}),[_e.join(),st,it,ze.duration,Mt,Ne.loop]),Ct=e.useCallback((()=>{var e;if(!_e[0]||!_e[1])return;E(c,te.current,le);const t=ne.current;re.current&&t&&0!==(null===(e=le.current)||void 0===e?void 0:e.length)&&y((()=>((e,t,r,n)=>{var o,l,i,s;const c=null!==(l=null===(o=t[0])||void 0===o?void 0:o.querySelectorAll(".ms-slider-element"))&&void 0!==l?l:[],a=null!==(s=null===(i=t[1])||void 0===i?void 0:i.querySelectorAll(".ms-slider-element"))&&void 0!==s?s:[];function u(e,t,r,n){const o="x"===n?r.scrollLeft:r.scrollTop;e.forEach(((e,r)=>{const l="x"===n?t[0]:t[1];o>=l*r&&l*(r+1)>o?e.classList.add("active"):e.classList.remove("active")}))}c.length>0&&u(c,r,e,n),a.length>0&&u(a,r,e,"x")})(t,le.current,_e,u)),33)}),[_e.join(),u,ne,re,c]),Nt=e.useCallback((()=>{te.current&&((e,t,r,n)=>{var o,l;const{allIds:i,emptyKeysRaw:s}=(()=>{const t=[],r=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:e=>e instanceof Element&&e.hasAttribute(R)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP});let o=n.nextNode();for(;o;){const e=o,l=e.getAttribute(R);l&&(t.push(l),0===e.children.length&&r.push(l)),o=n.nextNode()}return{allIds:t,emptyKeysRaw:r}})(),c=new Set(null===(o=t.current)||void 0===o?void 0:o.loaded);i.forEach((e=>c.add(e)));let a=null;if(null===(l=t.current)||void 0===l?void 0:l.empty){const e=new Set(t.current.empty);s.forEach((t=>e.add(t))),a=Array.from(e)}t.current={loaded:"lazy"===n?Array.from(c):i.map((e=>e)),empty:a},r()})(te.current,ae,ee,qe.type)}),[Ee]),Ft=e.useCallback((e=>{(null==P?void 0:P.clickTrigger)&&((e,t,r)=>{const{selector:n,delay:o=0}="string"==typeof t?{selector:t}:t,l=e.target;if(!l.closest(n))return;const i=l.closest(`[${R}]`);i&&i.classList.add("remove"),y((()=>{i&&i.classList.remove("remove"),r()}),o)})(e,P.clickTrigger,Nt)}),[Se,Nt]),Wt=e.useCallback((()=>{const e=te.current,t=ne.current;e&&t&&(null==p||p(t.scrollLeft,t.scrollTop),de.current=!0,null==h||h(!0),y((()=>{de.current=!1,null==h||h(!1),Nt()}),200),"scroll"!==c&&Ct(),requestAnimationFrame(ee))}),[p,h,c,Ct,Nt]),It=z(at,gt,et,ht({})),Ht=z((null===(J=ne.current)||void 0===J?void 0:J.scrollLeft)||0,yt,Ze[0],ht({xSize:!0})),Bt=e.useCallback((e=>{const t="object"==typeof H.wheel&&"string"==typeof H.wheel.changeDirectionKey?H.wheel.changeDirectionKey:"KeyX";e.code!==t||"hybrid"!==u||pe.current||(e.stopPropagation(),pe.current=!0,ee())}),[u,JSON.stringify(H.wheel)]),Yt=e.useCallback((e=>{pe.current&&(e.stopPropagation(),pe.current=!1,ee())}),[]);e.useEffect((()=>{(P||qe.type)&&(P||null===ae.current.empty||(ae.current.empty=null),Nt())}),[Se,qe.type,Nt]),e.useEffect((()=>{if(matchMedia("(pointer: coarse)").matches)return;const e=ne.current;if(!e)return;const t="hybrid"===u&&"object"==typeof H.wheel&&H.wheel.changeDirection?"x":u,r="hybrid"===u&&lt+Xe<=_e[1]||pe.current?["hybrid","y"].includes(t)?"x":"y":t,n=e=>{e.preventDefault(),function(e,t,r){const n=e.target.closest(".ms-element");n.matches(":focus")||n.focus(),t.animating||(t.targetScrollX=n.scrollLeft,t.targetScrollY=n.scrollTop),"x"===r?t.targetScrollX=x(t.targetScrollX+e.deltaY,0,n.scrollWidth-n.clientWidth+2):t.targetScrollY=x(t.targetScrollY+e.deltaY,0,n.scrollHeight-n.clientHeight+2),t.animating||(t.animating=!0,t.animationFrameId=requestAnimationFrame((function e(){let o=0;"x"===r?(n.scrollLeft+=.4*(t.targetScrollX-n.scrollLeft),o=Math.abs(n.scrollLeft-t.targetScrollX)):(n.scrollTop+=.4*(t.targetScrollY-n.scrollTop),o=Math.abs(n.scrollTop-t.targetScrollY)),o>2.5?t.animationFrameId=requestAnimationFrame(e):("x"===r?n.scrollLeft=t.targetScrollX:n.scrollTop=t.targetScrollY,t.animating=!1,null!==t.animationFrameId&&(cancelAnimationFrame(t.animationFrameId),t.animationFrameId=null))})))}(e,ue.current,r)};return H.wheel&&e.addEventListener("wheel",n,{passive:!1}),()=>{e.removeEventListener("wheel",n)}}),[u,Oe,lt,_e[1],Xe,pe.current]),e.useEffect((()=>{ze.value&&("hybrid"===u?["x","y"]:[u]).forEach((e=>{const t="x"===e?0:1;"end"===ze.value[t]&&kt(e,"x"===e?yt:gt)}))}),[u,ze.value.join(),xe,gt,yt,st,it]),e.useEffect((()=>{ze.value&&("hybrid"===u?["x","y"]:[u]).forEach((e=>{const t="x"===e?0:1,r=ze.value[t];"number"==typeof r&&kt(e,r)}))}),[xe,ze.updater,u,kt,ze.value.join()]),e.useEffect((()=>{const e=ue.current.animationFrameId;return(qe.type||h)&&h&&(h(!1),ee()),requestAnimationFrame((()=>se.current=!1)),()=>{e&&cancelAnimationFrame(e),ue.current.animationFrameId&&cancelAnimationFrame(ue.current.animationFrameId),he.current&&cancelAnimationFrame(he.current),b()}}),[]),e.useEffect((()=>{const e=ne.current;if(!e)return;const t=window.matchMedia("(pointer: coarse)").matches?"touchstart":"mousedown";if("touchstart"===t&&"slider"!==c)return;const r=t=>{"touchstart"===t.type?e.style.touchAction="none":e.style.touchAction&&e.style.removeProperty("touch-action"),Lt("wrapp",t.type)};return e.addEventListener(t,r,{passive:!1}),()=>{e.removeEventListener(t,r),e.style.removeProperty("touch-action")}}),[c]),e.useEffect((()=>{"scroll"!==c&&Ct()}),[_e.join()]);const Xt=e.useCallback(((t,r,n,o)=>{const l=Object.assign({width:rt[0]?rt[0]+"px":void 0,height:rt[1]?rt[1]+"px":void 0},qe.type&&Object.assign({position:"absolute",top:r+"px",left:n+"px"},!rt[0]&&1===nt[0]&&{transform:"translateX(-50%)"})),i=q?e.createElement(e.Suspense,{fallback:K},o):o;return e.createElement("div",Object.assign({key:t},qe.type||P?{[R]:""+t}:{},{className:"ms-object-box",style:l,onClick:Ft}),i)}),[q,!!K,rt.join(),Ee,Se,nt[0],Ft,qe.type]),Dt=e.useMemo((()=>[{positionType:"x"===u?"left":"top",visibility:ut},{positionType:"x"===u?"right":"bottom",visibility:dt},..."hybrid"===u?[{positionType:"left",visibility:mt},{positionType:"right",visibility:ft}]:[]]),[ut,dt,u,mt,ft]),$t=e.useMemo((()=>({width:_e[2]+"px",height:_e[3]+"px"})),[_e]),Pt=e.useMemo((()=>[{shouldRender:ht({withLimit:!1})<Ge,direction:u,thumbSize:ht({}),thumbSpace:It,objLengthPerSize:wt,progressReverseIndex:0},{shouldRender:"hybrid"===u&&ht({withLimit:!1,xSize:!0})<Ze[0],direction:"x",thumbSize:ht({xSize:!0}),thumbSpace:Ht,objLengthPerSize:Et[0],progressReverseIndex:1}].filter((({shouldRender:e})=>e))),[ht,et,u,Ze[0],It,Ht,wt,Et]),qt=e.useMemo((()=>{const e={position:"relative",width:_e[0]+"px",height:_e[1]+"px"};return H.arrows&&Ne.contentReduce&&Ne.size&&("x"===u?e.left=Ne.size+"px":"y"===u?e.top=Ne.size+"px":(e.top=Ne.size+"px",e.left=Ne.size+"px")),e}),[_e,Oe,Ne,u]),Kt=e.useMemo((()=>{var e;return null!==(e={x:st>_e[0]?"scroll hidden":"hidden",y:it>_e[1]?"hidden scroll":"hidden",hybrid:`${st>_e[0]?"scroll":"hidden"} ${it>_e[1]?"scroll":"hidden"}`,hide:"hidden"}[H.wheel||H.content?u:"hide"])&&void 0!==e?e:"hidden"}),[st,it,_e,Oe,u]),Vt=e.useMemo((()=>I?Dt.map((({positionType:t,visibility:r})=>e.createElement(a,{key:"edge-"+t,edgeGradient:Ce,visibility:r,edgeType:t}))):null),[I,Dt,Ce]),Ut=e.useMemo((()=>H.arrows?Dt.map((({positionType:t,visibility:r})=>e.createElement(d,{key:"arrow-"+t,activity:r,arrows:Ne,arrowType:t,handleArrow:Tt,size:"hybrid"===u?_e[0]+2*Ne.size:_e[0]}))):null),[H.arrows,Dt,Ne,Tt,_e[0],u,de.current]),_t=e.useMemo((()=>H.progressElement&&!0!==H.progressElement?Pt.map((t=>{const r="boolean"==typeof B?B:B[t.progressReverseIndex];return e.createElement(s,{key:t.direction+"",type:c,direction:t.direction,progressReverse:r,size:Ze,progressTrigger:H,scrollBarOnHover:Y,scrollBarEvent:"sliderMenu"===c?Mt:zt,thumbSize:t.thumbSize,thumbSpace:t.thumbSpace,objLengthPerSize:t.objLengthPerSize,sliderCheckLocal:Ct,duration:ze.duration})})):null),[H.progressElement,Pt,c,B,Ze,H,Y,Mt,zt,Ct,ze.duration]),Gt=e.createElement("div",{className:"ms-objects-wrapper",ref:oe,style:Ot},We.map(((t,r)=>{var n,l,s;const c=e.Children.toArray(i).find((r=>e.isValidElement(r)&&r.key===t)),a=qe.stopLoadOnScroll&&de.current&&!ae.current.loaded.includes(""+t)?K:(null===(n=ae.current.empty)||void 0===n?void 0:n.includes(t))?"object"==typeof(null==P?void 0:P.mode)?P.mode.fallback:K:c,d="number"==typeof tt[0]&&"number"==typeof tt[1]||"firstChild"!==tt[0]&&"firstChild"!==tt[1]||0!==r?a:e.createElement(o,{onResize:Rt},a);if(!qe.type)return Xt(t,0,0,d);{const{elementTop:e,elementBottom:n,left:o,right:i}=vt[r],c="x"===u?Ve:Ue,a=Ge+c>("x"===u?o:e)-at&&("x"===u?i:n)-at>0-c,m="hybrid"!==u||_e[0]+Ve>o-((null===(l=ne.current)||void 0===l?void 0:l.scrollLeft)||0)&&i-((null===(s=ne.current)||void 0===s?void 0:s.scrollLeft)||0)>0-Ve;if(a&&m)return Xt(t,e,o,d)}}))),Jt=e.createElement("div",{"morph-scroll":""+Q,className:n,ref:te,style:$t},e.createElement("div",{className:"ms-content",ref:re,onMouseEnter:At,onMouseLeave:At,onTouchStart:At,onTouchEnd:At,style:qt},e.createElement("div",{className:"ms-element",ref:ne,onScroll:Wt,onKeyDown:Bt,onKeyUp:Yt,style:Object.assign(Object.assign(Object.assign({width:"100%",height:"100%",outline:"none"},xt),{overflow:Kt}),"scroll"!==c||"boolean"!=typeof H.progressElement||!1===H.progressElement?{scrollbarWidth:"none"}:{})},rt[0]&&rt[1]?Gt:e.createElement(o,{onResize:St,style:xt},Gt)),Vt,_t),Ut);return"auto"===g?e.createElement(o,{measure:"outer",onResize:jt},Jt):Jt};T.displayName="MorphScroll";const C={MorphScroll:T,ResizeTracker:o,IntersectionTracker:n};export{n as IntersectionTracker,T as MorphScroll,o as ResizeTracker,C as default};
