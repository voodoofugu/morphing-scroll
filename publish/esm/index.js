import e,{useMemo as t,useEffect as r,useRef as n}from"react";const o=(e,t=!1,r)=>{let n=[];if(n=Array.isArray(e)?2===e.length?[e[1],e[0],e[1],e[0]]:[...e]:[e,e,e,e],t&&(n=[n[1],n[0],n[3],n[2]]),r){const e=[];for(let t=0;r>t;t++)e.push(n[t%4]);n=e}return n},l=({className:t,children:r,style:n,root:l,threshold:i,rootMargin:s,visibleContent:c=!1,onIntersection:a})=>{const[u,d]=e.useState(!1),m=e.useRef(null),p=e.useMemo((()=>{if(!s)return"";const e=o(s);return`${e[0]}px ${e[1]}px ${e[2]}px ${e[3]}px`}),[s]),h=e.useCallback((([e])=>{d(e.isIntersecting),a&&a({time:e.time,rootBounds:e.rootBounds,boundingClientRect:e.boundingClientRect,intersectionRect:e.intersectionRect,isIntersecting:e.isIntersecting,intersectionRatio:e.intersectionRatio,target:e.target})}),[a]);return e.useEffect((()=>{const e=new IntersectionObserver(h,{root:l,threshold:i,rootMargin:p});return m.current&&e.observe(m.current),()=>{e.disconnect()}}),[h,l,i,p]),e.createElement("div",{"intersection-tracker":"",className:t,ref:m,style:n},c||u?r:null)};l.displayName="IntersectionTracker";const i=({className:t,children:r,style:n,measure:o="inner",onResize:l})=>{const i=e.useRef(null);e.useEffect((()=>{const e=i.current;if(!e)return;const t=new ResizeObserver((e=>{for(const t of e)l&&l(t.contentRect)}));return t.observe(e),()=>{t.unobserve(e),t.disconnect()}}),[o,l]);const s={width:"max-content",height:"max-content"},c={inner:Object.assign({},s),outer:Object.assign({},{width:"100%",height:"100%"}),all:Object.assign({minWidth:"100%",minHeight:"100%"},s)};return e.createElement("div",{"resize-tracker":"",className:t,ref:i,style:Object.assign(Object.assign({willChange:"width, height"},c[o]),n)},r)};function s(e,n){const o=t((()=>function(e,t){let r=null,n=null;const o=(...o)=>{"requestFrame"===t?(null!==n&&cancelAnimationFrame(n),n=requestAnimationFrame((()=>{e(...o),n=null}))):(null!==r&&clearTimeout(r),r=setTimeout((()=>{e(...o),r=null}),t))};return o.cancel=()=>{null!==r&&(clearTimeout(r),r=null),null!==n&&(cancelAnimationFrame(n),n=null)},o}(e,n)),[n,e]);return r((()=>()=>{o.cancel()}),[o]),o}i.displayName="ResizeTracker";let c=1;const a=({type:t,direction:r,progressReverse:n,size:o,progressTrigger:l,scrollBarOnHover:i,scrollBarEvent:s,thumbSize:c,thumbSpace:a,objLengthPerSize:u,sliderCheckLocal:d,duration:m})=>{const p="sliderMenu"!==t?{onMouseDown:s,onTouchStart:s}:{},h=e.useMemo((()=>{if("scroll"===t||!r)return;const n=["hybrid","y"].includes(r)?"y":"x",i="x"===n?o[0]:o[1];return Array.from({length:u},((r,o)=>e.createElement("div",{key:o,className:"ms-slider-element",style:Object.assign({},"sliderMenu"===t&&{cursor:"pointer"}),onClick:"sliderMenu"===t?()=>{s(i*o,n,m,d)}:void 0},Array.isArray(null==l?void 0:l.progressElement)?l.progressElement[o]:null==l?void 0:l.progressElement)))}),[u,r,o,t,s,null==l?void 0:l.progressElement,m,d]);return e.createElement(e.Fragment,null,"scroll"===t?e.createElement("div",{className:"ms-bar",style:Object.assign(Object.assign(Object.assign({position:"absolute",width:"fit-content"},"x"===r?Object.assign({transformOrigin:"left top",height:o[0]+"px"},n?{top:0,transform:"rotate(-90deg) translateX(-100%)"}:{transform:"rotate(-90deg)"}):Object.assign({top:0,height:"100%"},n?{left:0}:{right:0})),0!=!(null==l?void 0:l.progressElement)&&{pointerEvents:"none"}),i&&{opacity:0,transition:"opacity 0.1s ease-in-out"})},e.createElement("div",Object.assign({className:"ms-thumb","data-direction":["hybrid","y"].includes(r)?"y":r},p,{style:Object.assign(Object.assign({height:c+"px",willChange:"transform, height",transform:`translateY(${a}px)`},(null==l?void 0:l.progressElement)&&{cursor:"grab"}),{transition:"height 0.05s ease-in-out"})}),null==l?void 0:l.progressElement)):u>1&&(null==l?void 0:l.progressElement)&&e.createElement("div",Object.assign({className:"ms-slider","data-direction":["hybrid","y"].includes(r)?"y":r},p,{style:Object.assign(Object.assign(Object.assign({position:"absolute",display:"flex"},"slider"===t&&{cursor:"grab"}),i&&{opacity:0,transition:"opacity 0.1s ease-in-out"}),"x"===r?Object.assign({transformOrigin:"left top",left:"50%",transform:"translateX(-50%)"},n?{top:0}:{bottom:0}):Object.assign({flexDirection:"column",top:"50%",transform:"translateY(-50%)"},n?{left:0}:{right:0}))}),h))};a.displayName="ScrollBar";var u=e.memo(a);const d=({edgeGradient:t,visibility:r,edgeType:n})=>{if(!t)return null;const o=Object.assign(Object.assign(Object.assign(Object.assign({position:"absolute",pointerEvents:"none",transition:"opacity 0.1s ease-in-out"},t.color&&{background:t.color&&`linear-gradient(${"right"===n||"left"===n?"90deg, ":""}${t.color}, transparent)`}),"right"===n||"left"===n?{height:"100%",width:t.size+"px",top:0}:{width:"100%",height:t.size+"px",left:0}),n?{[n]:0}:{}),"right"===n?{transform:"scaleX(-1)"}:"bottom"===n?{transform:"scaleY(-1)"}:{});return e.createElement("div",{className:"ms-edge"+(n?" "+n:""),style:Object.assign(Object.assign({},o),{opacity:r?1:0})})};d.displayName="Edge";var m=e.memo(d);const p=({activity:t,arrows:r,arrowType:n,handleArrow:o,size:l})=>{const i=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({position:"absolute",display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer",width:r.size+"px"},n?{[n]:0}:{}),"top"===n&&{transform:"rotate(-90deg) translateX(-100%)",transformOrigin:"left top"}),"bottom"===n&&{transform:"rotate(90deg) translateX(-100%)",transformOrigin:"left bottom"}),"left"===n&&{transform:"scaleX(-1)"}),["top","bottom"].includes(n)?{height:l+"px"}:{height:"100%",top:0});return e.createElement("div",{className:`ms-arrow-box ${n}${t?" active":""}`,style:Object.assign({},i),onClick:()=>o(n)},r.element)};p.displayName="Arrow";var h=e.memo(p);function f(e,t){return e>t?Math.floor(e/t):1}function g(e,t=0,r=1/0){return Math.max(t,Math.min(Math.round(e),r))}const y=(e,t,r)=>{if(!t)return;const n=t.querySelectorAll("."+("scroll"===e?"ms-thumb":"ms-slider"));n.length>0&&(r.current=n)},v=e=>e?"start"===e?"flex-start":"center"===e?"center":"flex-end":void 0;function b(e,t,r=0,n=0){return o=>{var l,i,s,c;const a={width:(null!==(l=o.width)&&void 0!==l?l:0)-r,height:(null!==(i=o.height)&&void 0!==i?i:0)-n};(null===(s=e.current)||void 0===s?void 0:s.width)===a.width&&(null===(c=e.current)||void 0===c?void 0:c.height)===a.height||(e.current=a,t())}}function x(t){const r=[],n=t=>{if(null===t||"number"==typeof t||"boolean"==typeof t||"bigint"==typeof t)r.push(t+"");else if("string"==typeof t)r.push(t);else if("function"==typeof t)r.push("<function>");else if(e.isValidElement(t))r.push("<react-node>");else if(Array.isArray(t))t.forEach(n);else if("object"==typeof t){const e=Object.entries(t).sort((([e],[t])=>e.localeCompare(t)));for(const[,t]of e)n(t)}else void 0===t&&r.push("<undefined>")};return n(t),r.join("/")}function E(e){var t,r,n;const o={x:"touches"in e.mouseEvent?e.mouseEvent.touches[0].clientX:e.mouseEvent.clientX,y:"touches"in e.mouseEvent?e.mouseEvent.touches[0].clientY:e.mouseEvent.clientY,leftover:null!==(r=null===(t=e.prevCoordsRef.current)||void 0===t?void 0:t.leftover)&&void 0!==r?r:0},l=null!==(n=e.prevCoordsRef.current)&&void 0!==n?n:o,i={x:o.x-l.x,y:o.y-l.y};e.prevCoordsRef.current=o;const s=t=>{if(!e.scrollElementRef||!e.objectsWrapperRef)return;let r=0;const n="x"===t?"movementX"in e.mouseEvent?e.mouseEvent.movementX:i.x:"movementY"in e.mouseEvent?e.mouseEvent.movementY:i.y,o=e.scrollElementRef;if("thumb"===e.clicked){const i=e.objectsWrapperRef,s=getComputedStyle(i),c="x"===t?o.clientWidth:o.clientHeight,a="x"===t?i.clientWidth+parseFloat(s.marginLeft)+parseFloat(s.marginRight):i.clientHeight+parseFloat(s.marginTop)+parseFloat(s.marginBottom),u=c-e.thumbSize,d=a-c;if(0>=u||0>=d)return;const m=n*(d/u)+l.leftover,p=Math.trunc(m),h=m-p;e.prevCoordsRef.current.leftover=h,r=p}else r=-n;"x"===t?(o.scrollLeft+=r,e.scrollStateRef.targetScrollX=o.scrollLeft):(o.scrollTop+=r,e.scrollStateRef.targetScrollY=o.scrollTop)},c=t=>{const r=e.objectsWrapperRef;if(!r)return;const n="slider"===e.type&&"wrapp"===e.clicked?-1:1,o=i[t]*n,l="x"===t?e.sizeLocal[0]:e.sizeLocal[1],s="x"===t?r.offsetWidth:r.offsetHeight,c="x"===t?e.scrollElementRef.scrollLeft:e.scrollElementRef.scrollTop;e.numForSliderRef.current+=Math.abs(o),e.numForSliderRef.current>6&&!e.isScrollingRef.current&&(o>0&&s>c+l?e.smoothScroll(c+l,t,e.duration):0>o&&c>0&&e.smoothScroll(c-l,t,e.duration),e.numForSliderRef.current=0)},a=t=>{"thumb"===e.clicked?s(t):"wrapp"===e.clicked?"slider"===e.type?c(t):s(t):"slider"===e.clicked&&c(t)};"hybrid"===e.direction?"wrapp"===e.clicked?(a("x"),a("y")):e.axisFromAtr&&a(e.axisFromAtr):a(e.direction||"y")}function j(e){if(e.controller.abort(),document.body.style.removeProperty("cursor"),["thumb","slider"].includes(e.clicked)&&e.mouseOnEl(e.scrollBar),"wrapp"===e.clicked&&e.mouseOnEl(e.objectsWrapperRef),e.clickedObject.current="none",e.scrollBarOnHover){let t=e.mouseEvent.target,r=!1;for(;t&&t!==document.body;){if(t===e.scrollContentRef){r=!0;break}t=t.parentNode}r||e.mouseOnRefHandle(e.mouseEvent)}e.prevCoordsRef.current=null,e.triggerUpdate()}const w=e=>{e&&("grab"===e.style.cursor?(e.style.cursor="grabbing",e.classList.add("active")):"grabbing"===e.style.cursor&&(e.style.cursor="grab",e.classList.remove("active")))},O="wrap-id",S=new Map,R=(e,t,r)=>{M(e);const n=setTimeout((()=>{t(),S.delete(e)}),r);S.set(e,n)},M=e=>{const t=S.get(e);t&&(clearTimeout(t),S.delete(e))},k=({className:t,children:r,type:l="scroll",direction:a="y",scrollPosition:d,onScrollValue:p,isScrolling:M,size:k,objectsSize:T,crossCount:z,gap:A,wrapperMargin:C,wrapperMinSize:L,wrapperAlign:F,elementsAlign:N,elementsDirection:I="row",edgeGradient:$,progressTrigger:X={wheel:!0},progressReverse:W=!1,scrollBarOnHover:B=!1,render:H,emptyElements:Y,suspending:P=!1,fallback:D})=>{var q,K,V,U,G,_;const J=s((()=>{Tt()}),40),Q=s((()=>{kt()}),34),Z=function(){const e=n(null);return null===e.current&&(e.current=""+c++),e.current}();if(!k)throw Error(`Prop "size" is not provided\nMorphScroll〈♦${Z}〉`);Object.keys(X).length;const[ee,te]=e.useState(0),re=()=>{te((e=>"number"==typeof e&&1e3>e?e+1:0))},ne=e.useRef(null),oe=e.useRef(null),le=e.useRef(null),ie=e.useRef(null),se=e.useRef([]),ce=e.useRef(null),ae=e.useRef("none"),ue=e.useRef({loaded:[],empty:[]}),de=e.useRef({targetScrollY:0,targetScrollX:0,animating:!1,animationFrameId:0}),me=e.useRef(!1),pe=e.useRef(0),he=e.useRef(null),fe=e.useRef(!1);function ge(){return e.useRef({width:0,height:0})}const ye=ge(),ve=ge(),be=ge(),[xe,Ee,je,we,Oe,Se,Re,Me,ke,Te]=function(...e){return e.map(x)}(null==d?void 0:d.value,H,k,T,Y,L,F,A,X,ue.current.empty),ze=e.useMemo((()=>{var e,t;return{value:"number"==typeof(null==d?void 0:d.value)||"string"==typeof(null==d?void 0:d.value)?[d.value,d.value]:null!==(e=null==d?void 0:d.value)&&void 0!==e?e:[null],duration:null!==(t=null==d?void 0:d.duration)&&void 0!==t?t:200}}),[xe,null==d?void 0:d.duration]),Ae={color:null,size:40},Ce=e.useMemo((()=>"object"==typeof $?Object.assign(Object.assign({},Ae),$):Ae),[$]),Le=e.useMemo((()=>Object.assign(Object.assign({},Ae),"object"==typeof X.arrows?X.arrows:{})),[ke]),Fe=e.useCallback((t=>{if(null==t)return[];if(e.isValidElement(t)){const r=t;return r.type===e.Fragment?e.Children.toArray(r.props.children).flatMap(Fe):[r]}return[t]}),[]),Ne=e.useMemo((()=>e.Children.toArray(r).flatMap(Fe).map((t=>e.isValidElement(t)&&t.key?t.key+"":null)).filter((e=>null!==e)).filter((e=>{var t;return"clear"!==(null==Y?void 0:Y.mode)||!(null===(t=ue.current.empty)||void 0===t?void 0:t.includes(e))}))),[r,Fe,Oe,Te]),[Ie,$e,Xe,We]=C?o(C):[0,0,0,0],Be=Ie+Xe,He=We+$e,[Ye,Pe]=e.useMemo((()=>{var e,t;return"number"==typeof A?[A,A]:Array.isArray(A)?[null!==(e=A[1])&&void 0!==e?e:0,null!==(t=A[0])&&void 0!==t?t:0]:[0,0]}),[A]),De=e.useMemo((()=>o((null==H?void 0:H.rootMargin)||0,"x"===a)),[Ee,a]),[qe,Ke]=De?[De[2],De[0]]:[0,0],Ve=e.useMemo((()=>{const[e,t]=Array.isArray(k)?k:"number"==typeof k?[k,k]:[ye.current.width,ye.current.height];if(!X.arrows||!Le.size)return[e,t,e,t];const r=2*Le.size;let n=e,o=t;return"x"===a?n=e-r:"y"===a?o=t-r:"hybrid"===a&&(n=e-r,o=t-r),[n,o,e,t]}),[je,ke,a,Le.size,ye.current.height,ye.current.width]),Ue="x"===a?Ve[0]:Ve[1],Ge=e.useMemo((()=>T?Array.isArray(T)?T:o(T,!0,2):[null,null]),[we]),_e=e.useMemo((()=>{const e=(e,t)=>"number"==typeof e?e:"firstChild"===e?t:0;return[e(Ge[0]&&"none"!==Ge[0]&&"size"!==Ge[0]?Ge[0]:"y"===a&&"none"!==Ge[0]||"size"===Ge[0]?Ve[0]:0,be.current.width),e(Ge[1]&&"none"!==Ge[1]&&"size"!==Ge[1]?Ge[1]:"x"===a&&"none"!==Ge[1]||"size"===Ge[1]?Ve[1]:0,be.current.height)]}),[Ge,a,be.current.width,be.current.height,Ve.join()]),Je=e.useMemo((()=>{const e="x"===a,t="row"===I,r="column"===I,n=e?Ve[1]:Ve[0],o=e?_e[1]+Pe:_e[0]+Ye,l="hybrid"===a?o*(Ne.length+1)-o:n,i=Math.floor(l/o)||1,s=z&&i>=z?"hybrid"===a?Math.ceil(i/z):z:i,c=s>1&&s<Ne.length?Math.ceil(Ne.length/s):s>Ne.length?1:Ne.length,u=z&&z<Ne.length,d=e=>Number.isFinite(e)&&e>0?e:1;if("hybrid"===a){const e=u?t?z:s:t?Ne.length:1,n=u?r?z:s:r?Ne.length:1;return[d(e),d(n)]}return[d(s),d(c)]}),[I,Pe,Ye,_e.join(),Ne.length,a,Ve.join(),z]),Qe=e.useMemo((()=>{const e=Je[0]?Je[0]*Pe-Pe:0,t="x"===a?Je[1]:Je[0];return _e[0]?(_e[0]+Pe)*t-Pe:(null==H?void 0:H.type)?be.current.width+e:ve.current.width}),[a,_e[0],Je.join(),Pe,ve.current.width,be.current.width,null==H?void 0:H.type]),Ze=e.useMemo((()=>{const e=1>Je[1]?1:Je[0]*Ye-Ye;return _e[1]?"x"===a?(_e[1]+Ye)*Je[0]-Ye:(_e[1]+Ye)*Je[1]-Ye:(null==H?void 0:H.type)?be.current.height+e:ve.current.height}),[a,_e[1],Je.join(),Ye,ve.current.height,be.current.height,null==H?void 0:H.type]),et=e.useMemo((()=>Ze+Be),[Ze,Be]),tt=e.useMemo((()=>Qe+He),[Qe,He]),rt="x"===a?tt:et,nt="x"===a?(null===(q=le.current)||void 0===q?void 0:q.scrollLeft)||0:(null===(K=le.current)||void 0===K?void 0:K.scrollTop)||0,ot=nt>1&&!0,lt=rt>Math.round(nt+Ue);let it=!1,st=!1;"hybrid"===a&&(it=((null===(V=le.current)||void 0===V?void 0:V.scrollLeft)||0)>1&&!0,st=Math.round(((null===(U=le.current)||void 0===U?void 0:U.scrollLeft)||0)+Ve[0])<tt);const ct=e.useMemo((()=>{if(!X.progressElement||!rt)return 0;const e=Math.round(Ue/rt*Ue);return!Number.isFinite(e)||0>e?0:e}),[Ue,rt,X.progressElement]),at=e.useMemo((()=>{if(!X.progressElement)return 0;const e=Math.round(Ve[0]/tt*Ve[0]);return!Number.isFinite(e)||0>e?0:e}),[Ve[0],tt,X.progressElement]),ut=e.useMemo((()=>Ue?rt-Ue:rt),[rt,Ue]),dt=e.useMemo((()=>Ve[0]?tt-Ve[0]:tt),[tt,Ve[0]]),mt=e.useCallback((()=>{if(!(null==H?void 0:H.type)||1>=Je[0])return[];const e=Array.from({length:Ne.length},((e,t)=>t)),t=Array.from({length:Je[0]},(()=>[])),r="x"===a&&"column"===I||"x"!==a&&"row"===I;return e.forEach((e=>{const n=r?e%Je[0]:Math.floor(e/Je[1]);t[n]&&t[n].push(e)})),t}),[Ne.length,Je.join(),null==H?void 0:H.type,I,a]),pt=e.useMemo((()=>{if(!(null==H?void 0:H.type))return[{elementTop:0,elementBottom:0,left:0,right:0}];let e=[],t=0;if(N){const r=Array.from({length:Ne.length},((e,t)=>t)),n=Math.abs(Math.floor(Ne.length/Je[0])*Je[0]-Ne.length);e=n?r.slice(-n):[],"center"===N?t=(_e[0]+Pe)*(Je[0]-n)/2:"end"===N&&(t=(_e[0]+Pe)*(Je[0]-n))}return Ne.map(((r,n)=>{const o=function(e,t){for(let r=0;r<t.length;r++){const n=t[r].indexOf(e);if(-1!==n)return["x"===a?n:r,["hybrid","y"].includes(a)?n:r]}return[0,0]}(n,mt()),l=e.length>0&&e.includes(n)?t:0,i=function(e){const t="x"===a?l:0;return e>0?t+(_e[1]+Ye)*e:t}(Je[0]>1||["hybrid","x"].includes(a)?o[1]:n),s=_e[1]?i+_e[1]:i,c=function(e){const t="x"===a?0:l;return e>0?t+(_e[0]+Pe)*e:t}(1===Je[0]&&"x"===a?n:o[0]);return{elementTop:i,elementBottom:s,left:c,right:c+_e[0]}}))}),[a,Je[0],_e.join(),Ye,Pe,null==H?void 0:H.type,I,N,mt,Ne.join()]),ht=e.useMemo((()=>(null==Ve?void 0:Ve.length)&&F?function(e,t,r,n){const[o,l="start"]="string"==typeof e?[e,e]:e,i={display:"flex"};return t[0]>r&&(i.justifyContent=v(o)),t[1]>n&&(i.alignItems=v(l)),i}(F,Ve,tt,et):{}),[F,Ve.join(),et,tt]),ft=e.useMemo((()=>[f(tt,Ve[0]),f(et,Ve[1])]),[tt,et,Ve.join()]),gt=e.useMemo((()=>"x"===a?ft[0]:ft[1]),[a,ft[0],ft[1]]),yt=s(b(ye,re),40),vt=s(b(ve,re,He,Be),40),bt=s(b(be,re),40),xt=e.useCallback(((e,t,r,n)=>{const o=le.current;return o?function(e,t,r,n,o){let l;if(!t&&!n)return null;const i=performance.now(),s=t.scrollTop,c=t.scrollLeft,a=u=>{const d=Math.min((u-i)/r,1);"y"===e?t.scrollTop=s+(n-s)*d:"x"===e&&(t.scrollLeft=c+(n-c)*d),1>d?l=requestAnimationFrame(a):null==o||o()};return l=requestAnimationFrame(a),()=>cancelAnimationFrame(l)}(t,o,r,e,n):null}),[]),Et=e.useCallback(((e,t,r)=>{if(ce.current){if(ce.current!==Ne[0])return void(ce.current=Ne[0])}else ce.current=Ne[0];const n=xt(t,e,ze.duration);n&&r.push(n)}),[Ne[0],ze.duration,xt]),jt=e.useMemo((()=>{const e=Object.assign(Object.assign(Object.assign(Object.assign({margin:C?`${Ie}px ${$e}px ${Xe}px ${We}px`:"",height:Ge[1]&&"none"!==Ge[1]?Ze+"px":"fit-content",width:Ge[0]&&"none"!==Ge[0]?Qe+"px":"fit-content"},X.content&&{cursor:"grab"}),A&&!(null==H?void 0:H.type)&&{gap:`${Ye}px ${Pe}px`}),L&&function(e,t,r,n,o){const l=(e,t)=>"full"===e?("x"===t?r[0]:r[1])-("x"===t?n:o):e;if("hybrid"!==t&&!Array.isArray(e)){const r=l(e,t)+"px";return"x"===t?{minWidth:r}:{minHeight:r}}let i,s;return Array.isArray(e)?[i,s]=e:i=s=e,{minWidth:l(i,"x")+"px",minHeight:l(s,"y")+"px"}}(L,a,Ve,He,Be)),F&&{flexShrink:0});if(null==H?void 0:H.type)return Object.assign(Object.assign({},e),{position:"relative"});const t=Ge[1]?"wrap":void 0,r=1===Je[0]?"y"===a?"column":"row":I;return Object.assign(Object.assign({},e),{display:"flex",flexDirection:r,flexWrap:t,justifyContent:v(N)})}),[C,Re,Se,[Ie,$e,Xe,We,He,Be,Ye,Pe].join(),Ve.join(),Me,Ge[1],Ze,Qe,X.content,Me,null==H?void 0:H.type,a,Je[0],I,N]),wt=e.useCallback((e=>{if(!B)return;const t=()=>((e,t,r,n)=>{e&&e.querySelectorAll(".ms-bar").forEach(((e,t)=>{const o=e;["mouseleave","mouseup","touchend"].includes(r.type)?(o.style.opacity="0",o.classList.remove("hover"),o.classList.add("leave"),n(`mouseOnRef${t}-anim`,(()=>o.classList.remove("leave")),200)):(o.style.opacity="1",o.classList.add("hover"))}))})(oe.current,0,e,R);"mouseleave"===e.type?!["thumb","slider","wrapp"].includes(ae.current)&&t():t()}),[B]),Ot=e.useCallback(((e,t="mousedown",r)=>{const n=e||("scroll"===l?"thumb":"slider");if("wrapp"===e&&!X.content||["thumb","slider"].includes(n)&&!X.progressElement)return;y(l,ne.current,se);let o=null;r&&(o=r.getAttribute("data-direction")),function(e){const t=new AbortController,{signal:r}=t;e.clickedObject.current=e.clicked,e.triggerUpdate(),"mousedown"===e.eventType?(["thumb","slider"].includes(e.clicked)&&e.mouseOnEl(e.scrollBar),"wrapp"===e.clicked&&e.mouseOnEl(e.objectsWrapperRef),document.addEventListener("mousemove",(t=>E(Object.assign(Object.assign({},e),{mouseEvent:t}))),{signal:r}),document.addEventListener("mouseup",(r=>j(Object.assign(Object.assign({},e),{mouseEvent:r,controller:t}))),{signal:r})):"touchstart"===e.eventType&&(document.addEventListener("touchmove",(t=>{t.preventDefault(),E(Object.assign(Object.assign({},e),{mouseEvent:t}))}),{signal:r,passive:!1}),document.addEventListener("touchend",(r=>j(Object.assign(Object.assign({},e),{mouseEvent:r,controller:t}))),{signal:r})),document.body.style.cursor="grabbing"}({eventType:t,scrollElementRef:le.current,objectsWrapperRef:ie.current,scrollBar:r||null,clickedObject:ae,scrollContentRef:oe.current,scrollStateRef:de.current,type:l,scrollBarOnHover:B,mouseOnEl:w,mouseOnRefHandle:wt,triggerUpdate:re,direction:a,smoothScroll:xt,sizeLocal:[Ve[0],Ve[1]],clicked:n,numForSliderRef:pe,isScrollingRef:me,prevCoordsRef:he,thumbSize:"x"===o?at:ct,axisFromAtr:o,duration:ze.duration})}),[a,l,X.content,X.progressElement,Ve.join(),ct,at,ze.duration,xt,wt,B]),St=e.useCallback((e=>{Ot(null,e.type,e.target)}),[Ot]),Rt=e.useCallback((()=>{Ot("wrapp")}),[Ot]),Mt=e.useCallback((e=>{le.current&&(({arrowType:e,scrollElement:t,wrapSize:r,scrollSize:n,smoothScroll:o,duration:l})=>{const i=r[0],s=r[1],c=t.scrollTop,a=t.scrollLeft,u=["top","bottom"].includes(e)?s:i,d=(e,t)=>o(g(e,0,u),t,l);"top"===e&&c>0?d(c-n[1],"y"):"left"===e&&a>0&&d(a-n[0],"x"),"bottom"===e&&c+n[1]!==s?d(c+n[1],"y"):"right"===e&&a+n[0]!==i&&d(a+n[0],"x")})({arrowType:e,scrollElement:le.current,wrapSize:[tt,et],scrollSize:Ve,smoothScroll:xt,duration:ze.duration})}),[Ve.join(),tt,et,ze.duration,xt]),kt=e.useCallback((()=>{y(l,ne.current,se);const e=le.current;oe.current&&e&&0!==se.current.length&&((e,t,r,n)=>{!function(){var o,l,i,s;const c=null!==(l=null===(o=t[0])||void 0===o?void 0:o.querySelectorAll(".ms-slider-element"))&&void 0!==l?l:[],a=null!==(s=null===(i=t[1])||void 0===i?void 0:i.querySelectorAll(".ms-slider-element"))&&void 0!==s?s:[];function u(e,t,r,n){const o="x"===n?r.scrollLeft:r.scrollTop;e.forEach(((e,r)=>{const l="x"===n?t[0]:t[1];o>=l*r&&l*(r+1)>o?e.classList.add("active"):e.classList.remove("active")}))}c.length>0&&u(c,r,e,n),a.length>0&&u(a,r,e,"x")}()})(e,se.current,Ve,a)}),[Ve.join(),a,le,oe,l]),Tt=e.useCallback((()=>{ne.current&&((e,t,r,n)=>{const{allIds:o,emptyKeysRaw:l}=(()=>{const t=[],r=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:e=>e instanceof Element&&e.hasAttribute(O)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP});let o=n.nextNode();for(;o;){const e=o,l=e.getAttribute(O);l&&(t.push(l),0===e.children.length&&r.push(l)),o=n.nextNode()}return{allIds:t,emptyKeysRaw:r}})(),i=new Set(t.current.loaded);o.forEach((e=>i.add(e)));let s=null;if(t.current.empty){const e=new Set(t.current.empty);l.forEach((t=>e.add(t))),s=Array.from(e)}t.current={loaded:"lazy"===n?Array.from(i):o.map((e=>e)),empty:s},r()})(ne.current,ue,re,null==H?void 0:H.type)}),[Ee]),zt=e.useCallback((e=>{(null==Y?void 0:Y.clickTrigger)&&((e,t,r,n)=>{const o=e.target;if(!o.closest(r.selector))return;const l=o.closest(`[${O}]`);l&&l.classList.add("remove"),t("emptyKeys-anim",(()=>{l&&l.classList.remove("remove"),n()}),r.delay||0)})(e,R,Y.clickTrigger,Tt)}),[Oe,Tt]),At=e.useCallback((()=>{const e=le.current;e&&(null==p||p(e.scrollLeft,e.scrollTop),me.current=!0,null==M||M(!0),R("handleScroll-anim",(()=>{me.current=!1,null==M||M(!1),(null==H?void 0:H.type)?re():J()}),200),"slider"===l&&Q(),(null==H?void 0:H.type)||J(),re())}),[p,M,l,null==H?void 0:H.type,Q,Tt]),Ct=g(nt/ut*(Ue-ct),0,Ue-ct),Lt=g(((null===(G=le.current)||void 0===G?void 0:G.scrollLeft)||0)/dt*(Ve[0]-Ve[0]/tt*Ve[0]),0,Ve[0]-at),Ft=e.useCallback((e=>{const t="object"==typeof X.wheel&&X.wheel.changeDirectionKey?X.wheel.changeDirectionKey:"KeyX";e.code!==t||"hybrid"!==a||fe.current||(e.stopPropagation(),fe.current=!0,re())}),[a,JSON.stringify(X.wheel)]),Nt=e.useCallback((e=>{fe.current&&(e.stopPropagation(),fe.current=!1,re())}),[]);e.useEffect((()=>{(Y||(null==H?void 0:H.type))&&(Y||null===ue.current.empty||(ue.current.empty=null),J())}),[Oe,null==H?void 0:H.type,me.current,Ne.join(),Tt]),e.useEffect((()=>{const e=de.current.animationFrameId;return((null==H?void 0:H.type)||M)&&M&&(M(!1),re()),kt(),()=>{e&&cancelAnimationFrame(e),(()=>{for(const e of S.values())clearTimeout(e);S.clear()})()}}),[]),e.useEffect((()=>{const e=le.current;if(!e)return;const t=e=>e.preventDefault(),r="hybrid"===a&&"object"==typeof X.wheel&&X.wheel.changeDirection?"x":a,n="hybrid"===a&&Ze+Be<=Ve[1]||fe.current?["hybrid","y"].includes(r)?"x":"y":r,o=X.wheel?e=>{t(e),function(e,t,r){const n=e.target.closest(".ms-element");n.matches(":focus")||n.focus(),t.animating||(t.targetScrollX=n.scrollLeft,t.targetScrollY=n.scrollTop),"x"===r?t.targetScrollX=g(t.targetScrollX+e.deltaY,0,n.scrollWidth-n.clientWidth+2):t.targetScrollY=g(t.targetScrollY+e.deltaY,0,n.scrollHeight-n.clientHeight+2),t.animating||(t.animating=!0,t.animationFrameId=requestAnimationFrame((function e(){let o=0;"x"===r?(n.scrollLeft+=.4*(t.targetScrollX-n.scrollLeft),o=Math.abs(n.scrollLeft-t.targetScrollX)):(n.scrollTop+=.4*(t.targetScrollY-n.scrollTop),o=Math.abs(n.scrollTop-t.targetScrollY)),o>2.5?t.animationFrameId=requestAnimationFrame(e):(t.animating=!1,null!==t.animationFrameId&&(cancelAnimationFrame(t.animationFrameId),t.animationFrameId=null))})))}(e,de.current,n)}:t;return e.addEventListener("wheel",o,{passive:!1}),()=>{e.removeEventListener("wheel",o)}}),[a,JSON.stringify(X.wheel),Ze,Ve[1],Be,fe.current]),e.useEffect((()=>{if(!ze.value)return;const e=[];return("hybrid"===a?["x","y"]:[a]).forEach((t=>{const r="x"===t?0:1;"end"===ze.value[r]&&Et(t,"x"===t?dt:ut,e)})),()=>{e.forEach((e=>e()))}}),[a,ze.value.join(),xe,ut,dt,tt,et]),e.useEffect((()=>{if(!ze.value)return;const e=[];return("hybrid"===a?["x","y"]:[a]).forEach((t=>{const r="x"===t?0:1;"number"==typeof ze.value[r]&&Et(t,ze.value[r],e)})),()=>{e.forEach((e=>e()))}}),[xe,null==d?void 0:d.updater,a,Et,ze.value.join()]);const It=e.useCallback(((t,r,n,o)=>{var l;const i=Object.assign({width:_e[0]?_e[0]+"px":void 0,height:_e[1]?_e[1]+"px":void 0},(null==H?void 0:H.type)&&Object.assign({position:"absolute",top:r+"px",left:n+"px"},!_e[0]&&1===Je[0]&&{transform:"translateX(-50%)"})),s=P?e.createElement(e.Suspense,{fallback:D},o):o,c=(null===(l=null==Y?void 0:Y.clickTrigger)||void 0===l?void 0:l.selector)&&zt;return e.createElement("div",Object.assign({key:t},H||Y?{[O]:""+t}:{},{className:"ms-object-box",style:i,onClick:c}),s)}),[P,!!D,_e.join(),Ee,Oe,Je[0],zt]),$t=e.createElement("div",{className:"ms-objects-wrapper",ref:ie,onMouseDown:Rt,style:jt},Ne.map(((t,n)=>{var o,l,s;const c=e.Children.toArray(r).find((r=>e.isValidElement(r)&&r.key===t)),u=(null==H?void 0:H.stopLoadOnScroll)&&me.current&&!ue.current.loaded.includes(""+t)?D:(null===(o=ue.current.empty)||void 0===o?void 0:o.includes(t))?"object"==typeof(null==Y?void 0:Y.mode)?Y.mode.fallback:D:c,d="number"==typeof Ge[0]&&"number"==typeof Ge[1]||"firstChild"!==Ge[0]&&"firstChild"!==Ge[1]||0!==n?u:e.createElement(i,{onResize:bt},u);if(!(null==H?void 0:H.type))return It(t,0,0,d);{const{elementTop:e,elementBottom:r,left:o,right:i}=pt[n],c="x"===a?qe:Ke,u=Ue+c>("x"===a?o:e)-nt&&("x"===a?i:r)-nt>0-c,m="hybrid"!==a||Ve[0]+qe>o-((null===(l=le.current)||void 0===l?void 0:l.scrollLeft)||0)&&i-((null===(s=le.current)||void 0===s?void 0:s.scrollLeft)||0)>0-qe;if(u&&m)return It(t,e,o,d)}}))),Xt=[{positionType:"x"===a?"left":"top",visibility:ot},{positionType:"x"===a?"right":"bottom",visibility:lt},..."hybrid"===a?[{positionType:"left",visibility:it},{positionType:"right",visibility:st}]:[]],Wt=e.createElement("div",{"morph-scroll":`〈♦${Z}〉`,className:t,ref:ne,style:{width:Ve[2]+"px",height:Ve[3]+"px"}},e.createElement("div",{className:"ms-content",ref:oe,onMouseEnter:wt,onMouseLeave:wt,onTouchStart:wt,onTouchEnd:wt,style:Object.assign({position:"relative",width:Ve[0]+"px",height:Ve[1]+"px"},X.arrows&&Le.size&&("x"===a?{left:Le.size+"px"}:"y"===a?{top:Le.size+"px"}:{top:Le.size+"px",left:Le.size+"px"}))},e.createElement("div",{className:"ms-element",ref:le,onScroll:At,onKeyDown:Ft,onKeyUp:Nt,style:Object.assign(Object.assign(Object.assign({width:"100%",height:"100%",outline:"none"},ht),{overflow:null!==(_={x:tt>Ve[0]?"scroll hidden":"hidden",y:et>Ve[1]?"hidden scroll":"hidden",hybrid:`${tt>Ve[0]?"scroll":"hidden"} ${et>Ve[1]?"scroll":"hidden"}`,hide:"hidden"}[X.wheel||X.content?a:"hide"])&&void 0!==_?_:"hidden"}),"scroll"!==l||"boolean"!=typeof X.progressElement||!1===X.progressElement?{scrollbarWidth:"none"}:{})},_e[0]&&_e[1]?$t:e.createElement(i,{onResize:vt,style:Object.assign({},ht)},$t)),$&&Xt.map((({positionType:t,visibility:r})=>e.createElement(m,{key:"edge-"+t,edgeGradient:Ce,visibility:r,edgeType:t}))),X.progressElement&&!0!==X.progressElement&&[{shouldRender:rt>ct,direction:a,thumbSize:ct,thumbSpace:Ct,objLengthPerSize:gt,progressReverseIndex:0},{shouldRender:"hybrid"===a&&tt>at,direction:"x",thumbSize:at,thumbSpace:Lt,objLengthPerSize:ft[0],progressReverseIndex:1}].filter((({shouldRender:e})=>e)).map((t=>e.createElement(u,{key:t.direction,type:l,direction:t.direction,progressReverse:"boolean"==typeof W?W:W[t.progressReverseIndex],size:Ve,progressTrigger:X,scrollBarOnHover:B,scrollBarEvent:"sliderMenu"===l?xt:St,thumbSize:t.thumbSize,thumbSpace:t.thumbSpace,objLengthPerSize:t.objLengthPerSize,sliderCheckLocal:kt,duration:ze.duration})))),X.arrows&&Xt.map((({positionType:t,visibility:r})=>e.createElement(h,{key:"arrow-"+t,activity:r,arrows:Le,arrowType:t,handleArrow:Mt,size:"hybrid"===a?Ve[0]+2*Le.size:Ve[0]}))));return"auto"===k?e.createElement(i,{measure:"outer",onResize:yt},Wt):Wt};k.displayName="MorphScroll";const T={MorphScroll:k,ResizeTracker:i,IntersectionTracker:l};export{l as IntersectionTracker,k as MorphScroll,i as ResizeTracker,T as default};
