"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react");const t=(e,t=!1,r)=>{let n=[];if(n=Array.isArray(e)?2===e.length?[e[1],e[0],e[1],e[0]]:[...e]:[e,e,e,e],t&&(n=[n[1],n[0],n[3],n[2]]),r){const e=[];for(let t=0;r>t;t++)e.push(n[t%4]);n=e}return n},r=({className:r,children:n,style:o,root:l,threshold:s,rootMargin:i,visibleContent:c=!1,onIntersection:a})=>{const[u,d]=e.useState(!1),m=e.useRef(null),p=e.useMemo((()=>{if(!i)return"";const e=t(i);return`${e[0]}px ${e[1]}px ${e[2]}px ${e[3]}px`}),[i]),h=e.useCallback((([e])=>{d(e.isIntersecting),a&&a({time:e.time,rootBounds:e.rootBounds,boundingClientRect:e.boundingClientRect,intersectionRect:e.intersectionRect,isIntersecting:e.isIntersecting,intersectionRatio:e.intersectionRatio,target:e.target})}),[a]);return e.useEffect((()=>{const e=new IntersectionObserver(h,{root:l,threshold:s,rootMargin:p});return m.current&&e.observe(m.current),()=>{e.disconnect()}}),[h,l,s,p]),e.createElement("div",{"intersection-tracker":"",className:r,ref:m,style:o},c||u?n:null)};r.displayName="IntersectionTracker";const n=({className:t,children:r,style:n,measure:o="inner",onResize:l})=>{const s=e.useRef(null);e.useEffect((()=>{const e=s.current;if(!e)return;const t=new ResizeObserver((e=>{for(const t of e)l&&l(t.contentRect)}));return t.observe(e),()=>{t.unobserve(e),t.disconnect()}}),[o,l]);const i={width:"max-content",height:"max-content"},c={inner:Object.assign({},i),outer:Object.assign({},{width:"100%",height:"100%"}),all:Object.assign({minWidth:"100%",minHeight:"100%"},i)};return e.createElement("div",{"resize-tracker":"",className:t,ref:s,style:Object.assign(Object.assign({willChange:"width, height"},c[o]),n)},r)};n.displayName="ResizeTracker";let o=1;const l=({type:t,direction:r,progressReverse:n,size:o,progressTrigger:l,scrollBarOnHover:s,scrollBarEvent:i,thumbSize:c,thumbSpace:a,objLengthPerSize:u,sliderCheckLocal:d,duration:m})=>{const p="sliderMenu"!==t?{onMouseDown:i,onTouchStart:i}:{},h=e.useMemo((()=>{if("scroll"===t||!r)return;const n=["hybrid","y"].includes(r)?"y":"x",s="x"===n?o[0]:o[1];return Array.from({length:u},((r,o)=>e.createElement("div",{key:o,className:"ms-slider-element",style:Object.assign({},"sliderMenu"===t&&{cursor:"pointer"}),onClick:"sliderMenu"===t?()=>{i(s*o,n,m,d)}:void 0},Array.isArray(null==l?void 0:l.progressElement)?l.progressElement[o]:null==l?void 0:l.progressElement)))}),[u,r,o,t,i,null==l?void 0:l.progressElement,m,d]);return e.createElement(e.Fragment,null,"scroll"===t?e.createElement("div",{className:"ms-bar",style:Object.assign(Object.assign(Object.assign({position:"absolute",width:"fit-content"},"x"===r?Object.assign({transformOrigin:"left top",height:o[0]+"px",left:"50%"},n?{top:0,transform:"rotate(-90deg) translate(-100%, -50%)"}:{transform:"rotate(-90deg) translateY(-50%)"}):Object.assign({top:"50%",transform:"translateY(-50%)",height:o[1]+"px"},n?{left:0}:{right:0})),0!=!(null==l?void 0:l.progressElement)&&{pointerEvents:"none"}),s&&{opacity:0,transition:"opacity 0.1s ease-in-out"})},e.createElement("div",Object.assign({className:"ms-thumb","data-direction":["hybrid","y"].includes(r)?"y":r},p,{style:Object.assign(Object.assign({height:c+"px",willChange:"transform, height",transform:`translateY(${a}px)`},(null==l?void 0:l.progressElement)&&{cursor:"grab"}),{transition:"height 0.05s ease-in-out"})}),null==l?void 0:l.progressElement)):u>1&&(null==l?void 0:l.progressElement)&&e.createElement("div",Object.assign({className:"ms-slider","data-direction":["hybrid","y"].includes(r)?"y":r},p,{style:Object.assign(Object.assign(Object.assign({position:"absolute",display:"flex"},"slider"===t&&{cursor:"grab"}),s&&{opacity:0,transition:"opacity 0.1s ease-in-out"}),"x"===r?Object.assign({transformOrigin:"left top",left:"50%",transform:"translateX(-50%)"},n?{top:0}:{bottom:0}):Object.assign({flexDirection:"column",top:"50%",transform:"translateY(-50%)"},n?{left:0}:{right:0}))}),h))};l.displayName="ScrollBar";var s=e.memo(l);const i=({edgeGradient:t,visibility:r,edgeType:n})=>{if(!t)return null;const o=Object.assign(Object.assign(Object.assign(Object.assign({position:"absolute",pointerEvents:"none",transition:"opacity 0.1s ease-in-out"},t.color&&{background:t.color&&`linear-gradient(${"right"===n||"left"===n?"90deg, ":""}${t.color}, transparent)`}),"right"===n||"left"===n?{height:"100%",width:t.size+"px",top:0}:{width:"100%",height:t.size+"px",left:0}),n?{[n]:0}:{}),"right"===n?{transform:"scaleX(-1)"}:"bottom"===n?{transform:"scaleY(-1)"}:{});return e.createElement("div",{className:"ms-edge"+(n?" "+n:""),style:Object.assign(Object.assign({},o),{opacity:r?1:0})})};i.displayName="Edge";var c=e.memo(i);const a=({activity:t,arrows:r,arrowType:n,handleArrow:o,size:l})=>{const s=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({position:"absolute",display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer",width:r.size+"px"},n?{[n]:0}:{}),"top"===n&&{transform:"rotate(-90deg) translateX(-100%)",transformOrigin:"left top"}),"bottom"===n&&{transform:"rotate(90deg) translateX(-100%)",transformOrigin:"left bottom"}),"left"===n&&{transform:"scaleX(-1)"}),["top","bottom"].includes(n)?{height:l+"px"}:{height:"100%",top:0});return e.createElement("div",{className:`ms-arrow-box ${n}${t?" active":""}`,style:Object.assign({},s),onClick:()=>o(n)},r.element)};a.displayName="Arrow";var u=e.memo(a);function d(e,t){return e>t?Math.floor(e/t):1}function m(e,t=0,r=1/0){return Math.max(t,Math.min(Math.round(e),r))}const p=(e,t,r)=>{if(!t)return;const n=t.querySelectorAll("."+("scroll"===e?"ms-thumb":"ms-slider"));n.length>0&&(r.current=n)},h=e=>e?"start"===e?"flex-start":"center"===e?"center":"flex-end":void 0;function f(e,t,r=0,n=0){return o=>{var l,s,i,c;const a={width:(null!==(l=o.width)&&void 0!==l?l:0)-r,height:(null!==(s=o.height)&&void 0!==s?s:0)-n};(null===(i=e.current)||void 0===i?void 0:i.width)===a.width&&(null===(c=e.current)||void 0===c?void 0:c.height)===a.height||(e.current=a,t())}}function g(t){const r=[],n=t=>{if(null===t||"number"==typeof t||"boolean"==typeof t||"bigint"==typeof t)r.push(t+"");else if("string"==typeof t)r.push(t);else if("function"==typeof t)r.push("<function>");else if(e.isValidElement(t))r.push("<react-node>");else if(Array.isArray(t))t.forEach(n);else if("object"==typeof t){const e=Object.entries(t).sort((([e],[t])=>e.localeCompare(t)));for(const[,t]of e)n(t)}else void 0===t&&r.push("<undefined>")};return n(t),r.join("/")}function y(e){var t,r,n;const o={x:"touches"in e.mouseEvent?e.mouseEvent.touches[0].clientX:e.mouseEvent.clientX,y:"touches"in e.mouseEvent?e.mouseEvent.touches[0].clientY:e.mouseEvent.clientY,leftover:null!==(r=null===(t=e.prevCoordsRef.current)||void 0===t?void 0:t.leftover)&&void 0!==r?r:0},l=null!==(n=e.prevCoordsRef.current)&&void 0!==n?n:o,s={x:o.x-l.x,y:o.y-l.y};e.prevCoordsRef.current=o;const i=t=>{if(!e.scrollElementRef||!e.objectsWrapperRef)return;let r=0;const n="x"===t?"movementX"in e.mouseEvent?e.mouseEvent.movementX:s.x:"movementY"in e.mouseEvent?e.mouseEvent.movementY:s.y,o=e.scrollElementRef;if("thumb"===e.clicked){const s=e.objectsWrapperRef,i=getComputedStyle(s),c="x"===t?o.clientWidth:o.clientHeight,a="x"===t?o.clientWidth-e.scrollBarEdge[0]:o.clientHeight-e.scrollBarEdge[1],u="x"===t?s.clientWidth+parseFloat(i.marginLeft)+parseFloat(i.marginRight):s.clientHeight+parseFloat(i.marginTop)+parseFloat(i.marginBottom),d=a-e.thumbSize,m=u-c;if(0>=d||0>=m)return;const p=n*(m/d)+l.leftover,h=Math.trunc(p),f=p-h;e.prevCoordsRef.current.leftover=f,r=h}else r=-n;"x"===t?(o.scrollLeft+=r,e.scrollStateRef.targetScrollX=o.scrollLeft):(o.scrollTop+=r,e.scrollStateRef.targetScrollY=o.scrollTop)},c=t=>{const r=e.objectsWrapperRef;if(!r)return;const n="slider"===e.type&&"wrapp"===e.clicked?-1:1,o=s[t]*n,l="x"===t?e.sizeLocal[0]:e.sizeLocal[1],i="x"===t?r.offsetWidth:r.offsetHeight,c="x"===t?e.scrollElementRef.scrollLeft:e.scrollElementRef.scrollTop;e.numForSliderRef.current+=Math.abs(o),e.numForSliderRef.current>6&&!e.isScrollingRef.current&&(o>0&&i>c+l?e.smoothScroll(c+l,t,e.duration):0>o&&c>0&&e.smoothScroll(c-l,t,e.duration),e.numForSliderRef.current=0)},a=t=>{"thumb"===e.clicked?i(t):"wrapp"===e.clicked?"slider"===e.type?c(t):i(t):"slider"===e.clicked&&c(t)};"hybrid"===e.direction?"wrapp"===e.clicked?(a("x"),a("y")):e.axisFromAtr&&a(e.axisFromAtr):a(e.direction||"y")}function b(e){if(e.controller.abort(),document.body.style.removeProperty("cursor"),["thumb","slider"].includes(e.clicked)&&e.mouseOnEl(e.scrollBar),"wrapp"===e.clicked&&e.mouseOnEl(e.objectsWrapperRef),e.clickedObject.current="none",e.scrollBarOnHover){let t=e.mouseEvent.target,r=!1;for(;t&&t!==document.body;){if(t===e.scrollContentRef){r=!0;break}t=t.parentNode}r||e.mouseOnRefHandle(e.mouseEvent)}e.prevCoordsRef.current=null,e.triggerUpdate()}let v=0;const x={timeout:{tasks:[],timer:null},requestFrame:{tasks:[],rafId:null}},E={timeout:{scheduleNext(){const{tasks:e}=x.timeout;if(null!==x.timeout.timer&&(clearTimeout(x.timeout.timer),x.timeout.timer=null),0===e.length)return;const t=e[0],r=performance.now(),n=Math.max(0,t.runAt-r);x.timeout.timer=window.setTimeout((()=>{const t=performance.now(),r=[];for(;e.length&&e[0].runAt<=t;)r.push(e.shift());r.forEach((e=>e.callback())),E.timeout.scheduleNext()}),n)},clearAll(){null!==x.timeout.timer&&(clearTimeout(x.timeout.timer),x.timeout.timer=null),x.timeout.tasks=[]}},requestFrame:{scheduleNext(){const{tasks:e}=x.requestFrame;if(null!==x.requestFrame.rafId)return;if(0===e.length)return;const t=()=>{x.requestFrame.rafId=null;const r=performance.now(),n=[];for(;e.length&&e[0].runAt<=r;)n.push(e.shift());n.forEach((e=>e.callback())),e.length>0&&(x.requestFrame.rafId=requestAnimationFrame(t))};x.requestFrame.rafId=requestAnimationFrame(t)},clearAll(){null!==x.requestFrame.rafId&&(cancelAnimationFrame(x.requestFrame.rafId),x.requestFrame.rafId=null),x.requestFrame.tasks=[]}}},j=(e,t,r)=>{const n="task_"+v++,o="string"==typeof t?"requestFrame":"timeout";x[o].tasks=x[o].tasks.filter((e=>e.id!==n));const l="requestFrame"===o?performance.now():performance.now()+t,s={id:n,callback:e,runAt:l};let i=x[o].tasks.length;for(;i>0&&x[o].tasks[i-1].runAt>s.runAt;)i--;return x[o].tasks.splice(i,0,s),E[o].scheduleNext(),n},w="wrap-id";function O(e,t,r,n){if(!t)return 0;const o=Math.round(e/t*r);return!Number.isFinite(o)||n>o?n:o}const k=e=>{e&&("grab"===e.style.cursor?(e.style.cursor="grabbing",e.classList.add("active")):"grabbing"===e.style.cursor&&(e.style.cursor="grab",e.classList.remove("active")))},S=({className:r,children:l,type:i="scroll",direction:a="y",scrollPosition:v,onScrollValue:x,isScrolling:S,size:M,objectsSize:R,crossCount:A,gap:z,wrapperMargin:T,wrapperMinSize:C,wrapperAlign:F,elementsAlign:L,elementsDirection:N="row",edgeGradient:I,progressTrigger:q={wheel:!0},progressReverse:B=!1,scrollBarOnHover:$=!1,scrollBarEdge:W,thumbMinSize:X,render:Y,emptyElements:H,suspending:P=!1,fallback:D})=>{var K,_,V,U,G;const J=function(){const t=e.useRef(null);return null===t.current&&(t.current=""+o++),t.current}();if(!M)throw Error(`Prop "size" is not provided\nMorphScroll〈♦${J}〉`);Object.keys(q).length;const[Q,Z]=e.useState(0),ee=()=>{Z((e=>"number"==typeof e&&1e3>e?e+1:0))},te=e.useRef(null),re=e.useRef(null),ne=e.useRef(null),oe=e.useRef(null),le=e.useRef([]),se=e.useRef(null),ie=e.useRef("none"),ce=e.useRef({loaded:[],empty:[]}),ae=e.useRef({targetScrollY:0,targetScrollX:0,animating:!1,animationFrameId:0}),ue=e.useRef(!1),de=e.useRef(0),me=e.useRef(null),pe=e.useRef(!1);function he(){return e.useRef({width:0,height:0})}const fe=he(),ge=he(),ye=he(),[be,ve,xe,Ee,je,we,Oe,ke,Se,Me,Re]=function(...e){return e.map(g)}(null==v?void 0:v.value,Y,M,R,H,C,F,z,q,ce.current.empty,W),Ae=e.useMemo((()=>{var e,t;return{value:"number"==typeof(null==v?void 0:v.value)||"string"==typeof(null==v?void 0:v.value)?[v.value,v.value]:null!==(e=null==v?void 0:v.value)&&void 0!==e?e:[null],duration:null!==(t=null==v?void 0:v.duration)&&void 0!==t?t:200}}),[be,null==v?void 0:v.duration]),ze={color:null,size:40},Te=e.useMemo((()=>"object"==typeof I?Object.assign(Object.assign({},ze),I):ze),[I]),Ce=e.useMemo((()=>Object.assign(Object.assign({},ze),"object"==typeof q.arrows?q.arrows:{})),[Se]),Fe=e.useCallback((t=>{if(null==t)return[];if(e.isValidElement(t)){const r=t;return r.type===e.Fragment?e.Children.toArray(r.props.children).flatMap(Fe):[r]}return[t]}),[]),Le=e.useMemo((()=>e.Children.toArray(l).flatMap(Fe).map((t=>e.isValidElement(t)&&t.key?t.key+"":null)).filter((e=>null!==e)).filter((e=>{var t;return"clear"!==(null==H?void 0:H.mode)||!(null===(t=ce.current.empty)||void 0===t?void 0:t.includes(e))}))),[l,Fe,je,Me]),[Ne,Ie,qe,Be]=T?t(T):[0,0,0,0],$e=Ne+qe,We=Be+Ie,[Xe,Ye]=e.useMemo((()=>{var e,t;return"number"==typeof z?[z,z]:Array.isArray(z)?[null!==(e=z[1])&&void 0!==e?e:0,null!==(t=z[0])&&void 0!==t?t:0]:[0,0]}),[z]),He=e.useMemo((()=>t((null==Y?void 0:Y.rootMargin)||0,"x"===a)),[ve,a]),[Pe,De]=He?[He[2],He[0]]:[0,0],Ke=e.useMemo((()=>{const[e,t]=Array.isArray(M)?M:"number"==typeof M?[M,M]:[fe.current.width,fe.current.height];if(!q.arrows||!Ce.size)return[e,t,e,t];const r=2*Ce.size;let n=e,o=t;return"x"===a?n=e-r:"y"===a?o=t-r:"hybrid"===a&&(n=e-r,o=t-r),[n,o,e,t]}),[xe,Se,a,Ce.size,fe.current.height,fe.current.width]),_e="x"===a?Ke[0]:Ke[1],Ve=e.useMemo((()=>{if(!W)return[0,0];if("number"==typeof W){const e=2*W;return[e,e]}if(Array.isArray(W)){const[e=0,t]=W;return[2*e,2*(null!=t?t:e)]}return[0,0]}),[Re]),Ue="x"===a?Ve[0]:Ve[1],Ge=e.useMemo((()=>[Ke[0]-Ve[0],Ke[1]-Ve[1]]),[Ve.join(),Ke[0],Ke[1]]),Je="x"===a?Ge[0]:Ge[1],Qe=e.useMemo((()=>R?Array.isArray(R)?R:t(R,!0,2):[null,null]),[Ee]),Ze=e.useMemo((()=>{const e=(e,t)=>"number"==typeof e?e:"firstChild"===e?t:0;return[e(Qe[0]&&"none"!==Qe[0]&&"size"!==Qe[0]?Qe[0]:"y"===a&&"none"!==Qe[0]||"size"===Qe[0]?Ke[0]:0,ye.current.width),e(Qe[1]&&"none"!==Qe[1]&&"size"!==Qe[1]?Qe[1]:"x"===a&&"none"!==Qe[1]||"size"===Qe[1]?Ke[1]:0,ye.current.height)]}),[Qe.join(),a,ye.current.width,ye.current.height,Ke.join()]),et=e.useMemo((()=>{const e="x"===a,t="row"===N,r="column"===N,n=e?Ke[1]:Ke[0],o=e?Ze[1]+Ye:Ze[0]+Xe,l="hybrid"===a?o*(Le.length+1)-o:n,s=Math.floor(l/o)||1,i=A&&s>=A?"hybrid"===a?Math.ceil(s/A):A:s,c=i>1&&i<Le.length?Math.ceil(Le.length/i):i>Le.length?1:Le.length,u=A&&A<Le.length,d=e=>Number.isFinite(e)&&e>0?e:1;if("hybrid"===a){const e=u?t?A:i:t?Le.length:1,n=u?r?A:i:r?Le.length:1;return[d(e),d(n)]}return[d(i),d(c)]}),[N,Ye,Xe,Ze.join(),Le.length,a,Ke.join(),A]),tt=e.useMemo((()=>{const e=et[0]?et[0]*Ye-Ye:0,t="x"===a?et[1]:et[0];return Ze[0]?(Ze[0]+Ye)*t-Ye:(null==Y?void 0:Y.type)?ye.current.width+e:ge.current.width}),[a,Ze[0],et.join(),Ye,ge.current.width,ye.current.width,null==Y?void 0:Y.type]),rt=e.useMemo((()=>{const e=1>et[1]?1:et[0]*Xe-Xe;return Ze[1]?"x"===a?(Ze[1]+Xe)*et[0]-Xe:(Ze[1]+Xe)*et[1]-Xe:(null==Y?void 0:Y.type)?ye.current.height+e:ge.current.height}),[a,Ze[1],et.join(),Xe,ge.current.height,ye.current.height,null==Y?void 0:Y.type]),nt=e.useMemo((()=>rt+$e),[rt,$e]),ot=e.useMemo((()=>tt+We),[tt,We]),lt="x"===a?ot:nt,st="x"===a?(null===(K=ne.current)||void 0===K?void 0:K.scrollLeft)||0:(null===(_=ne.current)||void 0===_?void 0:_.scrollTop)||0,it=st>1&&!0,ct=lt>Math.round(st+_e);let at=!1,ut=!1;"hybrid"===a&&(at=((null===(V=ne.current)||void 0===V?void 0:V.scrollLeft)||0)>1&&!0,ut=Math.round(((null===(U=ne.current)||void 0===U?void 0:U.scrollLeft)||0)+Ke[0])<ot);const dt=e.useMemo((()=>null!=X?X:30),[X]),mt=e.useMemo((()=>q.progressElement&&lt?O(Je,lt,Je,dt):0),[Je,lt,q.progressElement,dt]),pt=e.useMemo((()=>q.progressElement?O(Ge[0],ot,Ge[0],dt):0),[Ge[0],ot,q.progressElement,dt]),ht=e.useMemo((()=>_e?lt-_e:lt),[lt,_e]),ft=e.useMemo((()=>Ke[0]?ot-Ke[0]:ot),[ot,Ke[0]]),gt=e.useCallback((()=>{if(!(null==Y?void 0:Y.type)||1>=et[0])return[];const e=Array.from({length:Le.length},((e,t)=>t)),t=Array.from({length:et[0]},(()=>[])),r="x"===a&&"column"===N||"x"!==a&&"row"===N;return e.forEach((e=>{const n=r?e%et[0]:Math.floor(e/et[1]);t[n]&&t[n].push(e)})),t}),[Le.length,et.join(),null==Y?void 0:Y.type,N,a]),yt=e.useMemo((()=>{if(!(null==Y?void 0:Y.type))return[{elementTop:0,elementBottom:0,left:0,right:0}];let e=[],t=0;if(L){const r=Array.from({length:Le.length},((e,t)=>t)),n=Math.abs(Math.floor(Le.length/et[0])*et[0]-Le.length);e=n?r.slice(-n):[],"center"===L?t=(Ze[0]+Ye)*(et[0]-n)/2:"end"===L&&(t=(Ze[0]+Ye)*(et[0]-n))}return Le.map(((r,n)=>{const o=function(e,t){for(let r=0;r<t.length;r++){const n=t[r].indexOf(e);if(-1!==n)return["x"===a?n:r,["hybrid","y"].includes(a)?n:r]}return[0,0]}(n,gt()),l=e.length>0&&e.includes(n)?t:0,s=function(e){const t="x"===a?l:0;return e>0?t+(Ze[1]+Xe)*e:t}(et[0]>1||["hybrid","x"].includes(a)?o[1]:n),i=Ze[1]?s+Ze[1]:s,c=function(e){const t="x"===a?0:l;return e>0?t+(Ze[0]+Ye)*e:t}(1===et[0]&&"x"===a?n:o[0]);return{elementTop:s,elementBottom:i,left:c,right:c+Ze[0]}}))}),[a,et[0],Ze.join(),Xe,Ye,null==Y?void 0:Y.type,N,L,gt,Le.join()]),bt=e.useMemo((()=>(null==Ke?void 0:Ke.length)&&F?function(e,t,r,n){const[o,l="start"]="string"==typeof e?[e,e]:e,s={display:"flex"};return t[0]>r&&(s.justifyContent=h(o)),t[1]>n&&(s.alignItems=h(l)),s}(F,Ke,ot,nt):{}),[F,Ke.join(),nt,ot]),vt=e.useMemo((()=>[d(ot,Ke[0]),d(nt,Ke[1])]),[ot,nt,Ke.join()]),xt=e.useMemo((()=>"x"===a?vt[0]:vt[1]),[a,vt[0],vt[1]]),Et=e.useCallback(f(fe,ee),[fe.current.height,fe.current.width]),jt=e.useCallback(f(ge,ee,We,$e),[ge.current.height,ge.current.width,We,$e]),wt=e.useCallback(f(ye,ee),[ye.current.height,ye.current.width]),Ot=e.useCallback(((e,t,r,n)=>{const o=ne.current;return o?function(e,t,r,n,o){let l;if(!t&&!n)return null;const s=performance.now(),i=t.scrollTop,c=t.scrollLeft,a=u=>{const d=Math.min((u-s)/r,1);"y"===e?t.scrollTop=i+(n-i)*d:"x"===e&&(t.scrollLeft=c+(n-c)*d),1>d?l=requestAnimationFrame(a):null==o||o()};return l=requestAnimationFrame(a),()=>cancelAnimationFrame(l)}(t,o,r,e,n):null}),[]),kt=e.useCallback(((e,t,r)=>{if(se.current){if(se.current!==Le[0])return void(se.current=Le[0])}else se.current=Le[0];const n=Ot(t,e,Ae.duration);n&&r.push(n)}),[Le[0],Ae.duration,Ot]),St=e.useMemo((()=>{const e=Object.assign(Object.assign(Object.assign(Object.assign({margin:T?`${Ne}px ${Ie}px ${qe}px ${Be}px`:"",height:Qe[1]&&"none"!==Qe[1]?rt+"px":"fit-content",width:Qe[0]&&"none"!==Qe[0]?tt+"px":"fit-content"},q.content&&{cursor:"grab"}),z&&!(null==Y?void 0:Y.type)&&{gap:`${Xe}px ${Ye}px`}),C&&function(e,t,r,n,o){const l=(e,t)=>"full"===e?("x"===t?r[0]:r[1])-("x"===t?n:o):e;if("hybrid"!==t&&!Array.isArray(e)){const r=l(e,t)+"px";return"x"===t?{minWidth:r}:{minHeight:r}}let s,i;return Array.isArray(e)?[s,i]=e:s=i=e,{minWidth:l(s,"x")+"px",minHeight:l(i,"y")+"px"}}(C,a,Ke,We,$e)),F&&{flexShrink:0});if(null==Y?void 0:Y.type)return Object.assign(Object.assign({},e),{position:"relative"});const t=Qe[1]?"wrap":void 0,r=1===et[0]?"y"===a?"column":"row":N;return Object.assign(Object.assign({},e),{display:"flex",flexDirection:r,flexWrap:t,justifyContent:h(L)})}),[T,Oe,we,[Ne,Ie,qe,Be,We,$e,Xe,Ye].join(),Ke.join(),ke,Qe[1],rt,tt,q.content,ke,null==Y?void 0:Y.type,a,et[0],N,L]),Mt=e.useCallback((e=>{if(!$)return;const t=()=>((e,t,r)=>{e&&e.querySelectorAll(".ms-bar").forEach(((e,t)=>{const n=e;["mouseleave","mouseup","touchend"].includes(r.type)?(n.style.opacity="0",n.classList.remove("hover"),n.classList.add("leave"),j((()=>n.classList.remove("leave")),200)):(n.style.opacity="1",n.classList.add("hover"))}))})(re.current,0,e);"mouseleave"===e.type?!["thumb","slider","wrapp"].includes(ie.current)&&t():t()}),[$]),Rt=e.useCallback(((e,t="mousedown",r)=>{const n=e||("scroll"===i?"thumb":"slider");if("wrapp"===e&&!q.content||["thumb","slider"].includes(n)&&!q.progressElement)return;p(i,te.current,le);let o=null;r&&(o=r.getAttribute("data-direction")),function(e){const t=new AbortController,{signal:r}=t;e.clickedObject.current=e.clicked,e.triggerUpdate(),"mousedown"===e.eventType?(["thumb","slider"].includes(e.clicked)&&e.mouseOnEl(e.scrollBar),"wrapp"===e.clicked&&e.mouseOnEl(e.objectsWrapperRef),document.addEventListener("mousemove",(t=>y(Object.assign(Object.assign({},e),{mouseEvent:t}))),{signal:r}),document.addEventListener("mouseup",(r=>b(Object.assign(Object.assign({},e),{mouseEvent:r,controller:t}))),{signal:r})):"touchstart"===e.eventType&&(document.addEventListener("touchmove",(t=>{t.preventDefault(),y(Object.assign(Object.assign({},e),{mouseEvent:t}))}),{signal:r,passive:!1}),document.addEventListener("touchend",(r=>b(Object.assign(Object.assign({},e),{mouseEvent:r,controller:t}))),{signal:r})),document.body.style.cursor="grabbing"}({eventType:t,scrollElementRef:ne.current,objectsWrapperRef:oe.current,scrollBar:r||null,clickedObject:ie,scrollContentRef:re.current,scrollStateRef:ae.current,type:i,scrollBarOnHover:$,mouseOnEl:k,mouseOnRefHandle:Mt,triggerUpdate:ee,direction:a,smoothScroll:Ot,sizeLocal:[Ke[0],Ke[1]],clicked:n,numForSliderRef:de,isScrollingRef:ue,prevCoordsRef:me,thumbSize:"x"===o?pt:mt,axisFromAtr:o,duration:Ae.duration,scrollBarEdge:Ve})}),[a,i,q.content,q.progressElement,Ke.join(),mt,pt,Ae.duration,Ot,Mt,$,Ve.join()]),At=e.useCallback((e=>{Rt(null,e.type,e.target)}),[Rt]),zt=e.useCallback((()=>{Rt("wrapp")}),[Rt]),Tt=e.useCallback((e=>{ne.current&&(({arrowType:e,scrollElement:t,wrapSize:r,scrollSize:n,smoothScroll:o,duration:l})=>{const s=r[0],i=r[1],c=t.scrollTop,a=t.scrollLeft,u=["top","bottom"].includes(e)?i:s,d=(e,t)=>o(m(e,0,u),t,l);"top"===e&&c>0?d(c-n[1],"y"):"left"===e&&a>0&&d(a-n[0],"x"),"bottom"===e&&c+n[1]!==i?d(c+n[1],"y"):"right"===e&&a+n[0]!==s&&d(a+n[0],"x")})({arrowType:e,scrollElement:ne.current,wrapSize:[ot,nt],scrollSize:Ke,smoothScroll:Ot,duration:Ae.duration})}),[Ke.join(),ot,nt,Ae.duration,Ot]),Ct=e.useCallback((()=>{p(i,te.current,le);const e=ne.current;re.current&&e&&0!==le.current.length&&((e,t,r,n)=>{!function(){var o,l,s,i;const c=null!==(l=null===(o=t[0])||void 0===o?void 0:o.querySelectorAll(".ms-slider-element"))&&void 0!==l?l:[],a=null!==(i=null===(s=t[1])||void 0===s?void 0:s.querySelectorAll(".ms-slider-element"))&&void 0!==i?i:[];function u(e,t,r,n){const o="x"===n?r.scrollLeft:r.scrollTop;e.forEach(((e,r)=>{const l="x"===n?t[0]:t[1];o>=l*r&&l*(r+1)>o?e.classList.add("active"):e.classList.remove("active")}))}c.length>0&&u(c,r,e,n),a.length>0&&u(a,r,e,"x")}()})(e,le.current,Ke,a)}),[Ke.join(),a,ne,re,i]),Ft=e.useCallback((()=>{te.current&&((e,t,r,n)=>{const{allIds:o,emptyKeysRaw:l}=(()=>{const t=[],r=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:e=>e instanceof Element&&e.hasAttribute(w)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP});let o=n.nextNode();for(;o;){const e=o,l=e.getAttribute(w);l&&(t.push(l),0===e.children.length&&r.push(l)),o=n.nextNode()}return{allIds:t,emptyKeysRaw:r}})(),s=new Set(t.current.loaded);o.forEach((e=>s.add(e)));let i=null;if(t.current.empty){const e=new Set(t.current.empty);l.forEach((t=>e.add(t))),i=Array.from(e)}t.current={loaded:"lazy"===n?Array.from(s):o.map((e=>e)),empty:i},r()})(te.current,ce,ee,null==Y?void 0:Y.type)}),[ve]),Lt=e.useCallback((e=>{(null==H?void 0:H.clickTrigger)&&((e,t,r)=>{const n=e.target;if(!n.closest(t.selector))return;const o=n.closest(`[${w}]`);o&&o.classList.add("remove"),j((()=>{o&&o.classList.remove("remove"),r()}),t.delay||0)})(e,H.clickTrigger,Ft)}),[je,Ft]),Nt=e.useCallback((()=>{j((()=>{const e=ne.current;e&&(null==x||x(e.scrollLeft,e.scrollTop),ue.current=!0,null==S||S(!0),j((()=>{ue.current=!1,null==S||S(!1),Ft()}),200),"slider"===i&&j((()=>Ct()),33),ee())}),6)}),[x,S,i,Ct,Ft]),It=m(st/ht*(Je-mt),0,Je-mt),qt=m(((null===(G=ne.current)||void 0===G?void 0:G.scrollLeft)||0)/ft*(Ge[0]-Ge[0]/ot*Ge[0]),0,Ge[0]-pt),Bt=e.useCallback((e=>{const t="object"==typeof q.wheel&&"string"==typeof q.wheel.changeDirectionKey?q.wheel.changeDirectionKey:"KeyX";e.code!==t||"hybrid"!==a||pe.current||(e.stopPropagation(),pe.current=!0,ee())}),[a,JSON.stringify(q.wheel)]),$t=e.useCallback((e=>{pe.current&&(e.stopPropagation(),pe.current=!1,ee())}),[]);e.useEffect((()=>{(H||(null==Y?void 0:Y.type))&&(H||null===ce.current.empty||(ce.current.empty=null),Ft())}),[je,null==Y?void 0:Y.type,Ft]),e.useEffect((()=>{const e=ae.current.animationFrameId;return((null==Y?void 0:Y.type)||S)&&S&&(S(!1),ee()),Ct(),()=>{e&&cancelAnimationFrame(e),["timeout"].forEach((e=>E[e].clearAll()))}}),[]),e.useEffect((()=>{const e=ne.current;if(!e)return;const t=e=>e.preventDefault(),r="hybrid"===a&&"object"==typeof q.wheel&&q.wheel.changeDirection?"x":a,n="hybrid"===a&&rt+$e<=Ke[1]||pe.current?["hybrid","y"].includes(r)?"x":"y":r,o=q.wheel?e=>{t(e),function(e,t,r){const n=e.target.closest(".ms-element");n.matches(":focus")||n.focus(),t.animating||(t.targetScrollX=n.scrollLeft,t.targetScrollY=n.scrollTop),"x"===r?t.targetScrollX=m(t.targetScrollX+e.deltaY,0,n.scrollWidth-n.clientWidth+2):t.targetScrollY=m(t.targetScrollY+e.deltaY,0,n.scrollHeight-n.clientHeight+2),t.animating||(t.animating=!0,t.animationFrameId=requestAnimationFrame((function e(){let o=0;"x"===r?(n.scrollLeft+=.4*(t.targetScrollX-n.scrollLeft),o=Math.abs(n.scrollLeft-t.targetScrollX)):(n.scrollTop+=.4*(t.targetScrollY-n.scrollTop),o=Math.abs(n.scrollTop-t.targetScrollY)),o>2.5?t.animationFrameId=requestAnimationFrame(e):(t.animating=!1,null!==t.animationFrameId&&(cancelAnimationFrame(t.animationFrameId),t.animationFrameId=null))})))}(e,ae.current,n)}:t;return e.addEventListener("wheel",o,{passive:!1}),()=>{e.removeEventListener("wheel",o)}}),[a,JSON.stringify(q.wheel),rt,Ke[1],$e,pe.current]),e.useEffect((()=>{if(!Ae.value)return;const e=[];return("hybrid"===a?["x","y"]:[a]).forEach((t=>{const r="x"===t?0:1;"end"===Ae.value[r]&&kt(t,"x"===t?ft:ht,e)})),()=>{e.forEach((e=>e()))}}),[a,Ae.value.join(),be,ht,ft,ot,nt]),e.useEffect((()=>{if(!Ae.value)return;const e=[];return("hybrid"===a?["x","y"]:[a]).forEach((t=>{const r="x"===t?0:1;"number"==typeof Ae.value[r]&&kt(t,Ae.value[r],e)})),()=>{e.forEach((e=>e()))}}),[be,null==v?void 0:v.updater,a,kt,Ae.value.join()]);const Wt=e.useCallback(((t,r,n,o)=>{var l;const s=Object.assign({width:Ze[0]?Ze[0]+"px":void 0,height:Ze[1]?Ze[1]+"px":void 0},(null==Y?void 0:Y.type)&&Object.assign({position:"absolute",top:r+"px",left:n+"px"},!Ze[0]&&1===et[0]&&{transform:"translateX(-50%)"})),i=P?e.createElement(e.Suspense,{fallback:D},o):o,c=(null===(l=null==H?void 0:H.clickTrigger)||void 0===l?void 0:l.selector)&&Lt;return e.createElement("div",Object.assign({key:t},Y||H?{[w]:""+t}:{},{className:"ms-object-box",style:s,onClick:c}),i)}),[P,!!D,Ze.join(),ve,je,et[0],Lt]),Xt=e.useMemo((()=>[{positionType:"x"===a?"left":"top",visibility:it},{positionType:"x"===a?"right":"bottom",visibility:ct},..."hybrid"===a?[{positionType:"left",visibility:at},{positionType:"right",visibility:ut}]:[]]),[it,ct,a,at,ut]),Yt=e.useMemo((()=>({width:Ke[2]+"px",height:Ke[3]+"px"})),[Ke]),Ht=e.useMemo((()=>[{shouldRender:lt-Ue>mt,direction:a,thumbSize:mt,thumbSpace:It,objLengthPerSize:xt,progressReverseIndex:0},{shouldRender:"hybrid"===a&&pt<ot-Ve[0],direction:"x",thumbSize:pt,thumbSpace:qt,objLengthPerSize:vt[0],progressReverseIndex:1}].filter((({shouldRender:e})=>e))),[mt,lt,Ue,a,pt,ot,Ve[0],It,qt,xt,vt]),Pt=e.useMemo((()=>{const e={position:"relative",width:Ke[0]+"px",height:Ke[1]+"px"};return q.arrows&&Ce.size&&("x"===a?e.left=Ce.size+"px":"y"===a?e.top=Ce.size+"px":(e.top=Ce.size+"px",e.left=Ce.size+"px")),e}),[Ke,Se,Ce.size,a]),Dt=e.useMemo((()=>{var e;return null!==(e={x:ot>Ke[0]?"scroll hidden":"hidden",y:nt>Ke[1]?"hidden scroll":"hidden",hybrid:`${ot>Ke[0]?"scroll":"hidden"} ${nt>Ke[1]?"scroll":"hidden"}`,hide:"hidden"}[q.wheel||q.content?a:"hide"])&&void 0!==e?e:"hidden"}),[ot,nt,Ke[0],Ke[1],Se,a]),Kt=e.useMemo((()=>I?Xt.map((({positionType:t,visibility:r})=>e.createElement(c,{key:"edge-"+t,edgeGradient:Te,visibility:r,edgeType:t}))):null),[I,Xt,Te]),_t=e.useMemo((()=>q.arrows?Xt.map((({positionType:t,visibility:r})=>e.createElement(u,{key:"arrow-"+t,activity:r,arrows:Ce,arrowType:t,handleArrow:Tt,size:"hybrid"===a?Ke[0]+2*Ce.size:Ke[0]}))):null),[q.arrows,Xt,Ce,Tt,Ke[0],a]),Vt=e.useMemo((()=>q.progressElement&&!0!==q.progressElement?Ht.map((t=>{const r="boolean"==typeof B?B:B[t.progressReverseIndex];return e.createElement(s,{key:t.direction+"",type:i,direction:t.direction,progressReverse:r,size:Ge,progressTrigger:q,scrollBarOnHover:$,scrollBarEvent:"sliderMenu"===i?Ot:At,thumbSize:t.thumbSize,thumbSpace:t.thumbSpace,objLengthPerSize:t.objLengthPerSize,sliderCheckLocal:Ct,duration:Ae.duration})})):null),[q.progressElement,Ht,i,B,Ge,q,$,Ot,At,Ct,Ae.duration]),Ut=e.createElement("div",{className:"ms-objects-wrapper",ref:oe,onMouseDown:zt,style:St},Le.map(((t,r)=>{var o,s,i;const c=e.Children.toArray(l).find((r=>e.isValidElement(r)&&r.key===t)),u=(null==Y?void 0:Y.stopLoadOnScroll)&&ue.current&&!ce.current.loaded.includes(""+t)?D:(null===(o=ce.current.empty)||void 0===o?void 0:o.includes(t))?"object"==typeof(null==H?void 0:H.mode)?H.mode.fallback:D:c,d="number"==typeof Qe[0]&&"number"==typeof Qe[1]||"firstChild"!==Qe[0]&&"firstChild"!==Qe[1]||0!==r?u:e.createElement(n,{onResize:wt},u);if(!(null==Y?void 0:Y.type))return Wt(t,0,0,d);{const{elementTop:e,elementBottom:n,left:o,right:l}=yt[r],c="x"===a?Pe:De,u=_e+c>("x"===a?o:e)-st&&("x"===a?l:n)-st>0-c,m="hybrid"!==a||Ke[0]+Pe>o-((null===(s=ne.current)||void 0===s?void 0:s.scrollLeft)||0)&&l-((null===(i=ne.current)||void 0===i?void 0:i.scrollLeft)||0)>0-Pe;if(u&&m)return Wt(t,e,o,d)}}))),Gt=e.createElement("div",{"morph-scroll":`〈♦${J}〉`,className:r,ref:te,style:Yt},e.createElement("div",{className:"ms-content",ref:re,onMouseEnter:Mt,onMouseLeave:Mt,onTouchStart:Mt,onTouchEnd:Mt,style:Pt},e.createElement("div",{className:"ms-element",ref:ne,onScroll:Nt,onKeyDown:Bt,onKeyUp:$t,style:Object.assign(Object.assign(Object.assign({width:"100%",height:"100%",outline:"none"},bt),{overflow:Dt}),"scroll"!==i||"boolean"!=typeof q.progressElement||!1===q.progressElement?{scrollbarWidth:"none"}:{})},Ze[0]&&Ze[1]?Ut:e.createElement(n,{onResize:jt,style:bt},Ut)),Kt,Vt),_t);return"auto"===M?e.createElement(n,{measure:"outer",onResize:Et},Gt):Gt};S.displayName="MorphScroll";const M={MorphScroll:S,ResizeTracker:n,IntersectionTracker:r};exports.IntersectionTracker=r,exports.MorphScroll=S,exports.ResizeTracker=n,exports.default=M;
