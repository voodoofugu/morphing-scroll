"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react");const t=(e,t=!1,r)=>{let n=[];if(n=Array.isArray(e)?2===e.length?[e[1],e[0],e[1],e[0]]:[...e]:[e,e,e,e],t&&(n=[n[1],n[0],n[3],n[2]]),r){const e=[];for(let t=0;r>t;t++)e.push(n[t%4]);n=e}return n},r=({className:r,children:n,style:o,root:l,threshold:s,rootMargin:i,visibleContent:c=!1,onIntersection:a})=>{const[u,d]=e.useState(!1),m=e.useRef(null),f=e.useMemo((()=>{if(!i)return"";const e=t(i);return`${e[0]}px ${e[1]}px ${e[2]}px ${e[3]}px`}),[i]),p=e.useCallback((([e])=>{d(e.isIntersecting),a&&a({time:e.time,rootBounds:e.rootBounds,boundingClientRect:e.boundingClientRect,intersectionRect:e.intersectionRect,isIntersecting:e.isIntersecting,intersectionRatio:e.intersectionRatio,target:e.target})}),[a]);return e.useEffect((()=>{const e=new IntersectionObserver(p,{root:l,threshold:s,rootMargin:f});return m.current&&e.observe(m.current),()=>{e.disconnect()}}),[p,l,s,f]),e.createElement("div",{"intersection-tracker":"",className:r,ref:m,style:o},c||u?n:null)};r.displayName="IntersectionTracker";const n=({className:t,children:r,style:n,measure:o="inner",onResize:l})=>{const s=e.useRef(null);e.useEffect((()=>{const e=s.current;if(!e)return;const t=new ResizeObserver((e=>{for(const t of e)l&&l(t.contentRect)}));return t.observe(e),()=>{t.unobserve(e),t.disconnect()}}),[o,l]);const i={width:"max-content",height:"max-content"},c={inner:Object.assign({},i),outer:Object.assign({},{width:"100%",height:"100%"}),all:Object.assign({minWidth:"100%",minHeight:"100%"},i)};return e.createElement("div",{"resize-tracker":"",className:t,ref:s,style:Object.assign(Object.assign({willChange:"width, height"},c[o]),n)},r)};n.displayName="ResizeTracker";let o=1;const l=({type:t,direction:r,progressReverse:n,size:o,progressTrigger:l,scrollBarOnHover:s,scrollBarEvent:i,thumbSize:c,thumbSpace:a,objLengthPerSize:u,sliderCheckLocal:d,duration:m})=>{const f=e.useRef(null),p=e.useRef(null);e.useEffect((()=>{if(matchMedia("(pointer: coarse)").matches||!(null==l?void 0:l.wheel))return;const e=f.current;if(!e)return;const t="y"===e.getAttribute("data-direction")?"y":"x";let r=e.previousElementSibling;for(;r&&!r.classList.contains("ms-element");)r=r.previousElementSibling;const n=e=>{e.preventDefault(),null==r||r.scrollBy(Object.assign(Object.assign({},"y"===t?{top:e.deltaY}:{left:e.deltaY}),{behavior:"auto"}))};return e.addEventListener("wheel",n,{passive:!1}),()=>e.removeEventListener("wheel",n)}),[]),e.useEffect((()=>{const e=p.current;if(!e||"sliderMenu"===t)return;const r=window.matchMedia("(pointer: coarse)").matches?"touchstart":"mousedown",n=e=>{e.preventDefault(),e.stopPropagation(),i(e)};return e.addEventListener(r,n,{passive:!1}),()=>{e.removeEventListener(r,n)}}),[i]);const h=e.useMemo((()=>{if("scroll"===t||!r)return;const n=["hybrid","y"].includes(r)?"y":"x",s="x"===n?o[0]:o[1];return Array.from({length:u},((r,o)=>e.createElement("div",{key:o,className:"ms-slider-element",style:Object.assign({},"sliderMenu"===t&&{cursor:"pointer"}),onClick:"sliderMenu"===t?()=>{i(s*o,n,m,d)}:void 0},Array.isArray(null==l?void 0:l.progressElement)?l.progressElement[o]:null==l?void 0:l.progressElement)))}),[u,r,o,t,i,null==l?void 0:l.progressElement,m,d]);return e.createElement(e.Fragment,null,"scroll"===t?e.createElement("div",{className:"ms-bar",ref:f,"data-direction":["hybrid","y"].includes(r)?"y":"x",style:Object.assign(Object.assign(Object.assign({position:"absolute",width:"fit-content"},"x"===r?Object.assign({transformOrigin:"left top",height:o[0]+"px",left:"50%"},n?{top:0,transform:"rotate(-90deg) translate(-100%, -50%)"}:{transform:"rotate(-90deg) translateY(-50%)"}):Object.assign({top:"50%",transform:"translateY(-50%)",height:o[1]+"px"},n?{left:0}:{right:0})),0!=!(null==l?void 0:l.progressElement)&&{pointerEvents:"none"}),s&&{opacity:0,transition:"opacity 0.1s ease-in-out"})},e.createElement("div",{className:"ms-thumb",ref:p,style:Object.assign(Object.assign({height:c+"px",willChange:"transform, height",transform:`translateY(${a}px)`},(null==l?void 0:l.progressElement)&&{cursor:"grab"}),{transition:"height 0.05s ease-in-out"})},null==l?void 0:l.progressElement)):u>1&&(null==l?void 0:l.progressElement)&&e.createElement("div",{className:"ms-slider",ref:p,style:Object.assign(Object.assign(Object.assign({position:"absolute",display:"flex"},"slider"===t&&{cursor:"grab"}),s&&{opacity:0,transition:"opacity 0.1s ease-in-out"}),"x"===r?Object.assign({transformOrigin:"left top",left:"50%",transform:"translateX(-50%)"},n?{top:0}:{bottom:0}):Object.assign({flexDirection:"column",top:"50%",transform:"translateY(-50%)"},n?{left:0}:{right:0}))},h))};l.displayName="ScrollBar";var s=e.memo(l);const i=({edgeGradient:t,visibility:r,edgeType:n})=>{if(!t)return null;const o=Object.assign(Object.assign(Object.assign(Object.assign({position:"absolute",pointerEvents:"none",transition:"opacity 0.1s ease-in-out"},t.color&&{background:t.color&&`linear-gradient(${"right"===n||"left"===n?"270deg, ":""}${t.color}, transparent)`}),"right"===n||"left"===n?{height:"100%",width:t.size+"px",top:0}:{width:"100%",height:t.size+"px",left:0}),n?{[n]:0}:{}),"left"===n?{transform:"scaleX(-1)"}:"bottom"===n?{transform:"scaleY(-1)"}:{});return e.createElement("div",{className:"ms-edge"+(n?" "+n:""),style:Object.assign(Object.assign({},o),{opacity:r?1:0})})};i.displayName="Edge";var c=e.memo(i);const a=({activity:t,arrows:r,arrowType:n,handleArrow:o,size:l})=>{const s=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({position:"absolute",display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer",width:r.size+"px"},n?{[n]:0}:{}),"top"===n&&{transform:"rotate(-90deg) translateX(-100%)",transformOrigin:"left top"}),"bottom"===n&&{transform:"rotate(90deg) translateX(-100%)",transformOrigin:"left bottom"}),"left"===n&&{transform:"scaleX(-1)"}),["top","bottom"].includes(n)?{height:l+"px"}:{height:"100%",top:0});return e.createElement("div",{className:`ms-arrow-box ${n}${t?" active":""}`,style:Object.assign({},s),onClick:()=>o(n)},r.element)};a.displayName="Arrow";var u=e.memo(a);function d(e,t,r,n){return new(r||(r=Promise))((function(o,l){function s(e){try{c(n.next(e))}catch(e){l(e)}}function i(e){try{c(n.throw(e))}catch(e){l(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,i)}c((n=n.apply(e,t||[])).next())}))}"function"==typeof SuppressedError&&SuppressedError;let m=0;const f={tasks:[],timer:null,running:new Set},p=new Map,h={scheduleNext(){if(null!==f.timer&&(clearTimeout(f.timer),f.timer=null),0===f.tasks.length)return;const e=f.tasks[0],t=Math.max(0,e.runAt-performance.now());f.timer=window.setTimeout((()=>{f.timer=null;const e=performance.now(),t=[];for(;f.tasks.length&&f.tasks[0].runAt<=e&&!f.running.has(f.tasks[0].id);)t.push(f.tasks.shift());t.forEach((e=>{f.running.add(e.id);try{e.callback()}finally{f.running.delete(e.id)}})),h.scheduleNext()}),t)},clearAll(){null!==f.timer&&(clearTimeout(f.timer),f.timer=null),f.tasks=[],f.running.clear()}},g=(e,t,r,n)=>{const o=r||"task_"+m++;if(0===t)return e(),o;const l=n||"default",s=performance.now()+t;if("exclusive"===l){if(f.running.has(o)||f.tasks.some((e=>e.id===o)))return o;f.running.add(o);try{e()}finally{const e=window.setTimeout((()=>{f.running.delete(o),p.delete(o)}),t);p.set(o,e)}return o}r&&(f.tasks=f.tasks.filter((e=>e.id!==o)));const i={id:o,runAt:s,callback:()=>{f.running.add(o);try{e()}finally{f.running.delete(o)}}};return function(e,t){let r=0,n=e.length;for(;n>r;){const o=r+n>>1;e[o].runAt<t.runAt?r=o+1:n=o}e.splice(r,0,t)}(f.tasks,i),h.scheduleNext(),o},y=e=>{if(!e)return h.clearAll(),p.forEach((e=>clearTimeout(e))),void p.clear();(Array.isArray(e)?e:[e]).forEach((e=>{f.running.delete(e);const t=p.get(e);void 0!==t&&(clearTimeout(t),p.delete(e)),f.tasks=f.tasks.filter((t=>t.id!==e)),0===f.tasks.length?h.clearAll():h.scheduleNext()}))};function b(e,t){return e>t?Math.floor(e/t):1}function v(e,t=0,r=1/0){return Math.max(t,Math.min(Math.round(e),r))}const x=(e,t,r)=>{if(!t)return;const n=t.querySelectorAll("."+("scroll"===e?"ms-thumb":"ms-slider"));n.length>0&&(r.current=n)},E=e=>e?"start"===e?"flex-start":"center"===e?"center":"flex-end":void 0;function w(e,t,r=0,n=0){return o=>{var l,s,i,c;let a=!1;const u={width:(null!==(l=o.width)&&void 0!==l?l:0)-r,height:(null!==(s=o.height)&&void 0!==s?s:0)-n},d=0===u.width&&0===u.height;d&&!a&&(a=!0),(null===(i=e.current)||void 0===i?void 0:i.width)===u.width&&(null===(c=e.current)||void 0===c?void 0:c.height)===u.height||d&&a||(e.current=u,t())}}function j(t){const r=[],n=t=>{if(null===t||"number"==typeof t||"boolean"==typeof t||"bigint"==typeof t)r.push(t+"");else if("string"==typeof t)r.push(t);else if("function"==typeof t)r.push("<function>");else if(e.isValidElement(t))r.push("<react-node>");else if(Array.isArray(t))t.forEach(n);else if("object"==typeof t){const e=Object.entries(t).sort((([e],[t])=>e.localeCompare(t)));for(const[,t]of e)n(t)}else void 0===t&&r.push("<undefined>")};return n(t),r.join("/")}const S=(e,t)=>{if(e)if("grab"===e.style.cursor){if("mousedown"===t){const e=document.createElement("style");e.id="ms-cursor-lock",e.innerHTML="* {\n        cursor: grabbing !important;\n      }",document.head.appendChild(e)}e.style.cursor="grabbing",e.classList.add("active")}else if("grabbing"===e.style.cursor){if("mousedown"===t){const e=document.getElementById("ms-cursor-lock");e&&e.remove()}e.style.cursor="grab",e.classList.remove("active")}},R=(e,t,r,n)=>{const o=e;["thumb","slider"].includes(t)?S("slider"===t?null==r?void 0:r.closest(".ms-slider"):r,o):"wrapp"===t&&S(n,o)},M=(e,t,r)=>{var n,o,l,s,i;const c=r.scrollElementRef;if(!c)return;const a={x:"touches"in r.mouseEvent?r.mouseEvent.touches[0].clientX:r.mouseEvent.clientX,y:"touches"in r.mouseEvent?r.mouseEvent.touches[0].clientY:r.mouseEvent.clientY,leftover:null!==(o=null===(n=r.prevCoordsRef.current)||void 0===n?void 0:n.leftover)&&void 0!==o?o:0},u=null!==(l=r.prevCoordsRef.current)&&void 0!==l?l:a,d={x:a.x-u.x,y:a.y-u.y};r.prevCoordsRef.current=a;const m="wrapp"===r.clicked?-d[e]:d[e],f="y"===e?"scrollTop":"scrollLeft";if("thumb"===r.clicked)return void((e,t,r,n,o)=>{if(!t.scrollElementRef||!t.objectsWrapperRef)return;const l=t.scrollElementRef,s="x"===e?0:1;if(!Number.isFinite(o[s]))return;const i=t.objectsWrapperWH[s]+t["x"===e?"fullMarginX":"fullMarginY"],c=(t.scrollElementWH[s]-t.scrollBarEdge[s]-t.thumbSize)*o[s],a=i-t.scrollElementWH[s];if(0>=c||0>=a)return;const u=r*(a/c)+n.leftover,d=Math.trunc(u);if(t.prevCoordsRef.current&&(t.prevCoordsRef.current.leftover=u-d),"x"===e){const e="number"==typeof t.scrollStateRef.targetScrollX?t.scrollStateRef.targetScrollX:l.scrollLeft,r=l.scrollWidth-l.clientWidth;t.scrollStateRef.targetScrollX=v(e+d,0,r)}else{const e="number"==typeof t.scrollStateRef.targetScrollY?t.scrollStateRef.targetScrollY:l.scrollTop,r=l.scrollHeight-l.clientHeight;t.scrollStateRef.targetScrollY=v(e+d,0,r)}l.scrollLeft!==t.scrollStateRef.targetScrollX&&(l.scrollLeft=t.scrollStateRef.targetScrollX),l.scrollTop!==t.scrollStateRef.targetScrollY&&(l.scrollTop=t.scrollStateRef.targetScrollY)})(e,r,m,u,t);"slider"===r.type&&(r.numForSliderRef.current+=m);const p="x"===e?0:1;if("wrapp"===r.clicked){if(!Number.isFinite(t[p]))return;return void(c[f]+=m/t[p])}const h=c[f],g=Math.round((null===(i=null===(s=c.closest(".ms-content"))||void 0===s?void 0:s.querySelector(".ms-slider-element.active"))||void 0===i?void 0:i.getBoundingClientRect()["x"===e?"width":"height"])||1);if(Math.abs(r.numForSliderRef.current)>=g){const t=m>0&&h+r.sizeLocal[p]<r.wrapElWH[p]?h+r.sizeLocal[p]:0>m&&h>0?h-r.sizeLocal[p]:null;r.numForSliderRef.current=0,r.smoothScroll(t,e,10)}};function k(e){e.rafID.current&&(cancelAnimationFrame(e.rafID.current),e.rafID.current=NaN,y("smoothScrollBlock"));const t=e.scrollElementRef;t&&(e.scrollStateRef.targetScrollX=t.scrollLeft,e.scrollStateRef.targetScrollY=t.scrollTop);let r=0,n=0,o=[],l=[],s=[],i=[];if("thumb"===e.clicked){const t=getComputedStyle(e.objectsWrapperRef),s=e=>{const r=e=>parseFloat(e);return"x"===e?r(t.marginLeft)+r(t.marginRight):r(t.marginTop)+r(t.marginBottom)};r=s("x"),n=s("y"),o=[e.scrollElementRef.clientWidth,e.scrollElementRef.clientHeight],l=[e.objectsWrapperRef.clientWidth,e.objectsWrapperRef.clientHeight]}"slider"===e.type&&(s=[e.objectsWrapperRef.clientWidth,e.objectsWrapperRef.clientHeight]),["scroll","slider"].includes(e.type)&&(i=function(e){const t=e.getBoundingClientRect();return[t.width/e.clientWidth,t.height/e.clientHeight]}(e.scrollElementRef));const c=new AbortController,{signal:a}=c;e.clickedObject.current=e.clicked,e.triggerUpdate();R(e.eventType,e.clicked,e.scrollBar,e.objectsWrapperRef),document.addEventListener("pointermove",(t=>{return"touches"in(c=t)&&c.preventDefault(),void function(e){const t=e.direction||"y";"hybrid"===t?("wrapp"===e.clicked?["x","y"]:[e.axisFromAtr]).forEach((t=>t&&M(t,e.visualDiff,e))):M(t,e.visualDiff,e)}(Object.assign(Object.assign({},e),{mouseEvent:c,fullMarginX:r,fullMarginY:n,scrollElementWH:o,objectsWrapperWH:l,wrapElWH:s,visualDiff:i}));var c}),{passive:!1,signal:a}),document.addEventListener("pointerup",(t=>function(e){if(e.controller.abort(),R(e.eventType,e.clicked,e.scrollBar,e.objectsWrapperRef),e.clickedObject.current="none",e.scrollBarOnHover){let t=e.mouseEvent.target,r=!1;for(;t&&t!==document.body;){if(t===e.scrollContentRef){r=!0;break}t=t.parentNode}r||e.mouseOnRefHandle(e.mouseEvent)}if("slider"===e.type){const t=e.scrollElementRef;if(!t)return;const r=e.numForSliderRef.current,n="y"===e.direction?"scrollTop":"scrollLeft",o="y"===e.direction?t.clientHeight:t.clientWidth,l=e=>o*Math[e](t[n]/o);if(Math.abs(r)>20){const t=l(r>0?"ceil":"floor");e.smoothScroll(t,"y"===e.direction?"y":"x",e.duration)}else{const t=l(r>0?"floor":"ceil");e.smoothScroll(t,"y"===e.direction?"y":"x",e.duration)}e.numForSliderRef.current=0}e.prevCoordsRef.current=null,e.triggerUpdate()}(Object.assign(Object.assign({},e),{mouseEvent:t,controller:c}))),{signal:a})}const O="wrap-id";function A(e,t,r){return t?v(Math.round(e/t*e),r,e):0}function L(e,t,r,n){return t?v(e/t*(r-n),0,r-n):0}const z=({className:r,children:l,type:i="scroll",direction:a="y",scrollPosition:m,onScrollValue:f,isScrolling:p,size:h,objectsSize:S,crossCount:R,gap:M,wrapperMargin:z,wrapperMinSize:T,wrapperAlign:C,elementsAlign:N,elementsDirection:W="row",edgeGradient:F,progressTrigger:H={wheel:!0},progressReverse:I=!1,scrollBarOnHover:B=!1,scrollBarEdge:Y,thumbMinSize:X,render:$,emptyElements:D,suspending:P=!1,fallback:q})=>{var K,V,_,U,G;const J=function(){const t=e.useRef(null);return null===t.current&&(t.current=""+o++),t.current}();if(!h)throw Error(`Prop "size" is not provided\nMorphScroll〈♦${J}〉`);Object.keys(H).length;const[,Q]=e.useState({}),Z=()=>Q({}),ee=e.useRef(null),te=e.useRef(null),re=e.useRef(null),ne=e.useRef(null),oe=e.useRef([]),le=e.useRef(null),se=e.useRef(!0),ie=e.useRef("none"),ce=e.useRef({loaded:[],empty:[]}),ae=e.useRef({targetScrollY:0,targetScrollX:0,animating:!1,animationFrameId:0}),ue=e.useRef(!1),de=e.useRef(0),me=e.useRef(null),fe=e.useRef(!1),pe=e.useRef(NaN);function he(){return e.useRef({width:0,height:0})}const ge=he(),ye=he(),be=he(),[ve,xe,Ee,we,je,Se,Re,Me,ke,Oe,Ae]=function(...e){return e.map(j)}(m,$,h,S,D,T,C,M,H,ce.current.empty,Y),Le=e.useMemo((()=>{var e,t;let r=[null],n=200,o=null;if(null!=m)if("number"==typeof m||"end"===m)r=[m,m];else if(Array.isArray(m))r=m;else if("object"==typeof m){const l=m.value;"number"==typeof l||"end"===l?r=[l,l]:Array.isArray(l)&&(r=l),n=null!==(e=m.duration)&&void 0!==e?e:200,o=null!==(t=m.updater)&&void 0!==t?t:null}return{value:r,duration:n,updater:o}}),[ve]),ze={color:null,size:40},Te=e.useMemo((()=>"object"==typeof F?Object.assign(Object.assign({},ze),F):"string"==typeof F?{color:F,size:40}:ze),[F]),Ce=e.useMemo((()=>{const t=H.arrows,r={size:40,contentReduce:!0,loop:!1};return e.isValidElement(t)?Object.assign(Object.assign({},r),{element:t}):"object"==typeof t&&null!==t?Object.assign(Object.assign({},r),t):r}),[ke]),Ne=e.useCallback((t=>{if(null==t)return[];if(e.isValidElement(t)){const r=t;return r.type===e.Fragment?e.Children.toArray(r.props.children).flatMap(Ne):[r]}return[t]}),[]),We=e.useMemo((()=>e.Children.toArray(l).flatMap(Ne).map((t=>e.isValidElement(t)&&t.key?t.key+"":null)).filter((e=>null!==e)).filter((e=>{var t;return"clear"!==(null==D?void 0:D.mode)||!(null===(t=ce.current.empty)||void 0===t?void 0:t.includes(e))}))),[l,Ne,je,Oe]),[Fe,He,Ie,Be]=z?t(z):[0,0,0,0],Ye=Fe+Ie,Xe=Be+He,[$e,De]=e.useMemo((()=>{var e,t;return"number"==typeof M?[M,M]:Array.isArray(M)?[null!==(e=M[1])&&void 0!==e?e:0,null!==(t=M[0])&&void 0!==t?t:0]:[0,0]}),[M]),Pe=e.useMemo((()=>{const e={type:void 0,rootMargin:0,stopLoadOnScroll:!1};if("string"==typeof $)return Object.assign(Object.assign({},e),{type:$});if("object"==typeof $&&null!==$){const{type:e,rootMargin:t=0,stopLoadOnScroll:r=!1}=$;return{type:e,rootMargin:t,stopLoadOnScroll:r}}return e}),[xe]),qe=e.useMemo((()=>t(Pe.rootMargin,"x"===a)),[Pe.rootMargin,a]),[Ke,Ve]=qe?[qe[2],qe[0]]:[0,0],_e=e.useMemo((()=>{const[e,t]=Array.isArray(h)?h:"number"==typeof h?[h,h]:[ge.current.width,ge.current.height];if(!H.arrows||!Ce.size||!Ce.contentReduce)return[e,t,e,t];const r=2*Ce.size;let n=e,o=t;return"x"===a?n=e-r:"y"===a?o=t-r:"hybrid"===a&&(n=e-r,o=t-r),[n,o,e,t]}),[Ee,ke,a,Ce,ge.current.height,ge.current.width]),Ue="x"===a?_e[0]:_e[1],Ge=e.useMemo((()=>{if(!Y)return[0,0];if("number"==typeof Y){const e=2*Y;return[e,e]}if(Array.isArray(Y)){const[e=0,t]=Y;return[2*e,2*(null!=t?t:e)]}return[0,0]}),[Ae]),Je="x"===a?Ge[0]:Ge[1],Qe=e.useMemo((()=>[_e[0]-Ge[0],_e[1]-Ge[1]]),[Ge.join(),_e[0],_e[1]]),Ze="x"===a?Qe[0]:Qe[1],et=e.useMemo((()=>S?Array.isArray(S)?S:t(S,!0,2):[null,null]),[we]),tt=e.useMemo((()=>{const e=(e,t)=>"number"==typeof e?e:"firstChild"===e?t:0;return[e(et[0]&&"none"!==et[0]&&"size"!==et[0]?et[0]:"y"===a&&"none"!==et[0]||"size"===et[0]?_e[0]:0,be.current.width),e(et[1]&&"none"!==et[1]&&"size"!==et[1]?et[1]:"x"===a&&"none"!==et[1]||"size"===et[1]?_e[1]:0,be.current.height)]}),[et.join(),a,be.current.width,be.current.height,_e.join()]),rt=e.useMemo((()=>{const e="x"===a,t="row"===W,r="column"===W,n=e?_e[1]:_e[0],o=e?tt[1]+De:tt[0]+$e,l="hybrid"===a?o*(We.length+1)-o:n,s=Math.floor(l/o)||1,i=R&&s>=R?"hybrid"===a?Math.ceil(s/R):R:s,c=i>1&&i<We.length?Math.ceil(We.length/i):i>We.length?1:We.length,u=R&&R<We.length,d=e=>Number.isFinite(e)&&e>0?e:1;if("hybrid"===a){const e=u?t?R:i:t?We.length:1,n=u?r?R:i:r?We.length:1;return[d(e),d(n)]}return[d(i),d(c)]}),[W,De,$e,tt.join(),We.length,a,_e.join(),R]),nt=e.useMemo((()=>{const e=rt[0]?rt[0]*De-De:0,t="x"===a?rt[1]:rt[0];return tt[0]?(tt[0]+De)*t-De:Pe.type?be.current.width+e:ye.current.width}),[a,tt[0],rt.join(),De,ye.current.width,be.current.width,Pe.type]),ot=e.useMemo((()=>{const e=1>rt[1]?1:rt[0]*$e-$e;return tt[1]?"x"===a?(tt[1]+$e)*rt[0]-$e:(tt[1]+$e)*rt[1]-$e:Pe.type?be.current.height+e:ye.current.height}),[a,tt[1],rt.join(),$e,ye.current.height,be.current.height,Pe.type]),lt=e.useMemo((()=>ot+Ye),[ot,Ye]),st=e.useMemo((()=>nt+Xe),[nt,Xe]),it="x"===a?st:lt,ct="x"===a?(null===(K=re.current)||void 0===K?void 0:K.scrollLeft)||0:(null===(V=re.current)||void 0===V?void 0:V.scrollTop)||0,at=ct>1&&!0,ut=it>Math.round(ct+Ue);let dt=!1,mt=!1;"hybrid"===a&&(dt=((null===(_=re.current)||void 0===_?void 0:_.scrollLeft)||0)>1&&!0,mt=Math.round(((null===(U=re.current)||void 0===U?void 0:U.scrollLeft)||0)+_e[0])<st);const ft=e.useMemo((()=>null!=X?X:30),[X]),pt=e.useCallback((({withLimit:e=!0,xSize:t})=>H.progressElement&&it?t?A(e?Qe[0]:_e[0],e?st-Ge[0]:st,ft):A(e?Ze:Ue,e?it-Je:it,ft):0),[ke,it,Ze,Je,Ge[0],Ue,_e[0],Qe[0],st,ft]),ht=e.useMemo((()=>Ue?it-Ue:it),[it,Ue]),gt=e.useMemo((()=>_e[0]?st-_e[0]:st),[st,_e[0]]),yt=e.useCallback((()=>{if(!Pe.type||1>=rt[0])return[];const e=Array.from({length:We.length},((e,t)=>t)),t=Array.from({length:rt[0]},(()=>[])),r="x"===a&&"column"===W||"x"!==a&&"row"===W;return e.forEach((e=>{const n=r?e%rt[0]:Math.floor(e/rt[1]);t[n]&&t[n].push(e)})),t}),[We.length,rt.join(),Pe.type,W,a]),bt=e.useMemo((()=>{if(!Pe.type)return[{elementTop:0,elementBottom:0,left:0,right:0}];let e=[],t=0;if(N){const r=Array.from({length:We.length},((e,t)=>t)),n=Math.abs(Math.floor(We.length/rt[0])*rt[0]-We.length);e=n?r.slice(-n):[],"center"===N?t=(tt[0]+De)*(rt[0]-n)/2:"end"===N&&(t=(tt[0]+De)*(rt[0]-n))}return We.map(((r,n)=>{const o=function(e,t){for(let r=0;r<t.length;r++){const n=t[r].indexOf(e);if(-1!==n)return["x"===a?n:r,["hybrid","y"].includes(a)?n:r]}return[0,0]}(n,yt()),l=e.length>0&&e.includes(n)?t:0,s=function(e){const t="x"===a?l:0;return e>0?t+(tt[1]+$e)*e:t}(rt[0]>1||["hybrid","x"].includes(a)?o[1]:n),i=tt[1]?s+tt[1]:s,c=function(e){const t="x"===a?0:l;return e>0?t+(tt[0]+De)*e:t}(1===rt[0]&&"x"===a?n:o[0]);return{elementTop:s,elementBottom:i,left:c,right:c+tt[0]}}))}),[a,rt[0],tt.join(),$e,De,Pe.type,W,N,yt,We.join()]),vt=e.useMemo((()=>(null==_e?void 0:_e.length)&&C?function(e,t,r,n){const[o,l="start"]="string"==typeof e?[e,e]:e,s={display:"flex"};return t[0]>r&&(s.justifyContent=E(o)),t[1]>n&&(s.alignItems=E(l)),s}(C,_e,st,lt):{}),[C,_e.join(),lt,st]),xt=e.useMemo((()=>[b(st,_e[0]),b(lt,_e[1])]),[st,lt,_e.join()]),Et=e.useMemo((()=>"x"===a?xt[0]:xt[1]),[a,xt[0],xt[1]]),wt=e.useCallback(w(ge,Z),[]),jt=e.useCallback(w(ye,Z,Xe,Ye),[Xe,Ye]),St=e.useCallback(w(be,Z),[]),Rt=e.useCallback(((e,t,r)=>{const n=re.current;return n&&null!==e?function(e,t,r,n,o){return d(this,void 0,void 0,(function*(){if(!t||null==n)return null;const l="y"===e?"scrollTop":"scrollLeft",s=t[l];return s!==n?null===r?(yield function(e){return d(this,void 0,void 0,(function*(){for(;e.scrollHeight<=e.clientHeight&&e.scrollWidth<=e.clientWidth;)yield new Promise((e=>requestAnimationFrame(e)))}))}(t),void(t[l]=n)):void g((()=>{const e=performance.now(),i=()=>{const c=performance.now(),a=r?Math.min((c-e)/r,1):1;t[l]=s+(n-s)*a,1>a&&(o.current=requestAnimationFrame(i))};i()}),r,"smoothScrollBlock","exclusive"):void 0}))}(t,n,se.current?null:r,e,pe):null}),[se.current]),Mt=e.useCallback(((e,t)=>{if(le.current){if(le.current!==We[0])return void(le.current=We[0])}else le.current=We[0];Rt(t,e,Le.duration)}),[We[0],Le.duration,Rt]),kt=e.useMemo((()=>{const e=Object.assign(Object.assign(Object.assign(Object.assign({margin:z?`${Fe}px ${He}px ${Ie}px ${Be}px`:"",height:et[1]&&"none"!==et[1]?ot+"px":"fit-content",width:et[0]&&"none"!==et[0]?nt+"px":"fit-content"},H.content&&{cursor:"grab"}),M&&!Pe.type&&{gap:`${$e}px ${De}px`}),T&&function(e,t,r,n,o){const l=(e,t)=>"full"===e?("x"===t?r[0]:r[1])-("x"===t?n:o):e;if("hybrid"!==t&&!Array.isArray(e)){const r=l(e,t)+"px";return"x"===t?{minWidth:r}:{minHeight:r}}let s,i;return Array.isArray(e)?[s,i]=e:s=i=e,{minWidth:l(s,"x")+"px",minHeight:l(i,"y")+"px"}}(T,a,_e,Xe,Ye)),C&&{flexShrink:0});if(Pe.type)return Object.assign(Object.assign({},e),{position:"relative"});const t=et[1]?"wrap":void 0,r=1===rt[0]?"y"===a?"column":"row":W;return Object.assign(Object.assign({},e),{display:"flex",flexDirection:r,flexWrap:t,justifyContent:E(N)})}),[z,Re,Se,[Fe,He,Ie,Be,Xe,Ye,$e,De].join(),_e.join(),Me,et[1],ot,nt,H.content,Me,Pe.type,a,rt[0],W,N]),Ot=e.useCallback((e=>{if(!B)return;const t=()=>((e,t,r)=>{e&&e.querySelectorAll(".ms-bar").forEach(((e,t)=>{const n=e;["mouseleave","mouseup","touchend"].includes(r.type)?(n.style.opacity="0",n.classList.remove("hover"),n.classList.add("leave"),g((()=>n.classList.remove("leave")),200)):(n.style.opacity="1",n.classList.add("hover"))}))})(te.current,0,e);"mouseleave"===e.type?!["thumb","slider","wrapp"].includes(ie.current)&&t():t()}),[B]),At=e.useCallback(((e,t="mousedown",r)=>{var n;const o=e||("scroll"===i?"thumb":"slider");if("wrapp"===e&&!H.content||["thumb","slider"].includes(o)&&!H.progressElement)return;x(i,ee.current,oe);let l=null;r&&(l=null===(n=r.closest(".ms-bar"))||void 0===n?void 0:n.getAttribute("data-direction")),k({eventType:t,scrollElementRef:re.current,objectsWrapperRef:ne.current,scrollBar:r||null,clickedObject:ie,scrollContentRef:te.current,scrollStateRef:ae.current,type:i,scrollBarOnHover:B,mouseOnRefHandle:Ot,triggerUpdate:Z,direction:a,smoothScroll:Rt,sizeLocal:[_e[0],_e[1]],clicked:o,numForSliderRef:de,prevCoordsRef:me,thumbSize:pt("x"===l?{xSize:!0}:{}),axisFromAtr:l,duration:Le.duration,scrollBarEdge:Ge,rafID:pe})}),[a,i,H.content,H.progressElement,_e.join(),pt({}),pt({xSize:!0}),Le.duration,Rt,Ot,B,Ge.join()]),Lt=e.useCallback((e=>{At(null,e.type,e.target)}),[At]),zt=e.useCallback((e=>{re.current&&(({arrowType:e,scrollElement:t,wrapSize:r,scrollSize:n,smoothScroll:o,duration:l,loop:s})=>{const i=r[0],c=r[1],a=["top","bottom"].includes(e)?c:i,u=t.scrollTop,d=t.scrollLeft,m=t=>{o(t,["top","bottom"].includes(e)?"y":"x",l)};switch(e){case"top":u>0?m(u-n[1]):s&&m(a);break;case"left":d>0?m(d-n[0]):s&&m(a);break;case"right":d+n[0]<i?m(d+n[0]):s&&m(0);break;case"bottom":u+n[1]<c?m(u+n[1]):s&&m(0)}})({arrowType:e,scrollElement:re.current,wrapSize:[st,lt],scrollSize:_e,smoothScroll:Rt,duration:Le.duration,loop:Ce.loop})}),[_e.join(),st,lt,Le.duration,Rt,Ce.loop]),Tt=e.useCallback((()=>{if(!_e[0]||!_e[1])return;x(i,ee.current,oe);const e=re.current;te.current&&e&&0!==oe.current.length&&g((()=>((e,t,r,n)=>{var o,l,s,i;const c=null!==(l=null===(o=t[0])||void 0===o?void 0:o.querySelectorAll(".ms-slider-element"))&&void 0!==l?l:[],a=null!==(i=null===(s=t[1])||void 0===s?void 0:s.querySelectorAll(".ms-slider-element"))&&void 0!==i?i:[];function u(e,t,r,n){const o="x"===n?r.scrollLeft:r.scrollTop;e.forEach(((e,r)=>{const l="x"===n?t[0]:t[1];o>=l*r&&l*(r+1)>o?e.classList.add("active"):e.classList.remove("active")}))}c.length>0&&u(c,r,e,n),a.length>0&&u(a,r,e,"x")})(e,oe.current,_e,a)),33)}),[_e.join(),a,re,te,i]),Ct=e.useCallback((()=>{ee.current&&((e,t,r,n)=>{var o,l;const{allIds:s,emptyKeysRaw:i}=(()=>{const t=[],r=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:e=>e instanceof Element&&e.hasAttribute(O)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP});let o=n.nextNode();for(;o;){const e=o,l=e.getAttribute(O);l&&(t.push(l),0===e.children.length&&r.push(l)),o=n.nextNode()}return{allIds:t,emptyKeysRaw:r}})(),c=new Set(null===(o=t.current)||void 0===o?void 0:o.loaded);s.forEach((e=>c.add(e)));let a=null;if(null===(l=t.current)||void 0===l?void 0:l.empty){const e=new Set(t.current.empty);i.forEach((t=>e.add(t))),a=Array.from(e)}t.current={loaded:"lazy"===n?Array.from(c):s.map((e=>e)),empty:a},r()})(ee.current,ce,Z,Pe.type)}),[xe]),Nt=e.useCallback((e=>{(null==D?void 0:D.clickTrigger)&&((e,t,r)=>{const{selector:n,delay:o=0}="string"==typeof t?{selector:t}:t,l=e.target;if(!l.closest(n))return;const s=l.closest(`[${O}]`);s&&s.classList.add("remove"),g((()=>{s&&s.classList.remove("remove"),r()}),o)})(e,D.clickTrigger,Ct)}),[je,Ct]),Wt=e.useCallback((()=>{g((()=>{const e=ee.current,t=re.current;e&&t&&(null==f||f(t.scrollLeft,t.scrollTop),ue.current=!0,null==p||p(!0),g((()=>{ue.current=!1,null==p||p(!1),Ct()}),200),"scroll"!==i&&Tt(),requestAnimationFrame(Z))}),6)}),[f,p,i,Tt,Ct]),Ft=L(ct,ht,Ze,pt({})),Ht=L((null===(G=re.current)||void 0===G?void 0:G.scrollLeft)||0,gt,Qe[0],pt({xSize:!0})),It=e.useCallback((e=>{const t="object"==typeof H.wheel&&"string"==typeof H.wheel.changeDirectionKey?H.wheel.changeDirectionKey:"KeyX";e.code!==t||"hybrid"!==a||fe.current||(e.stopPropagation(),fe.current=!0,Z())}),[a,JSON.stringify(H.wheel)]),Bt=e.useCallback((e=>{fe.current&&(e.stopPropagation(),fe.current=!1,Z())}),[]);e.useEffect((()=>{(D||Pe.type)&&(D||null===ce.current.empty||(ce.current.empty=null),Ct())}),[je,Pe.type,Ct]),e.useEffect((()=>{if(matchMedia("(pointer: coarse)").matches)return;const e=re.current;if(!e)return;const t="hybrid"===a&&"object"==typeof H.wheel&&H.wheel.changeDirection?"x":a,r="hybrid"===a&&ot+Ye<=_e[1]||fe.current?["hybrid","y"].includes(t)?"x":"y":t,n=e=>{e.preventDefault(),function(e,t,r){const n=e.target.closest(".ms-element");n.matches(":focus")||n.focus(),t.animating||(t.targetScrollX=n.scrollLeft,t.targetScrollY=n.scrollTop),"x"===r?t.targetScrollX=v(t.targetScrollX+e.deltaY,0,n.scrollWidth-n.clientWidth+2):t.targetScrollY=v(t.targetScrollY+e.deltaY,0,n.scrollHeight-n.clientHeight+2),t.animating||(t.animating=!0,t.animationFrameId=requestAnimationFrame((function e(){let o=0;"x"===r?(n.scrollLeft+=.4*(t.targetScrollX-n.scrollLeft),o=Math.abs(n.scrollLeft-t.targetScrollX)):(n.scrollTop+=.4*(t.targetScrollY-n.scrollTop),o=Math.abs(n.scrollTop-t.targetScrollY)),o>2.5?t.animationFrameId=requestAnimationFrame(e):(t.animating=!1,null!==t.animationFrameId&&(cancelAnimationFrame(t.animationFrameId),t.animationFrameId=null))})))}(e,ae.current,r)};return H.wheel&&e.addEventListener("wheel",n,{passive:!1}),()=>{e.removeEventListener("wheel",n)}}),[a,ke,ot,_e[1],Ye,fe.current]),e.useEffect((()=>{Le.value&&("hybrid"===a?["x","y"]:[a]).forEach((e=>{const t="x"===e?0:1;"end"===Le.value[t]&&Mt(e,"x"===e?gt:ht)}))}),[a,Le.value.join(),ve,ht,gt,st,lt]),e.useEffect((()=>{Le.value&&("hybrid"===a?["x","y"]:[a]).forEach((e=>{const t="x"===e?0:1,r=Le.value[t];"number"==typeof r&&Mt(e,r)}))}),[ve,Le.updater,a,Mt,Le.value.join()]),e.useEffect((()=>{const e=ae.current.animationFrameId;return(Pe.type||p)&&p&&(p(!1),Z()),requestAnimationFrame((()=>se.current=!1)),()=>{e&&cancelAnimationFrame(e),y()}}),[]),e.useEffect((()=>{const e=re.current;if(!e)return;const t=window.matchMedia("(pointer: coarse)").matches?"touchstart":"mousedown";if("touchstart"===t&&"slider"!==i)return;const r=t=>{"touchstart"===t.type?e.style.touchAction="none":e.style.touchAction&&e.style.removeProperty("touch-action"),t.preventDefault(),At("wrapp",t.type)};return e.addEventListener(t,r,{passive:!1}),()=>{e.removeEventListener(t,r),e.style.removeProperty("touch-action")}}),[i]),e.useEffect((()=>{"scroll"!==i&&Tt()}),[_e.join()]);const Yt=e.useCallback(((t,r,n,o)=>{const l=Object.assign({width:tt[0]?tt[0]+"px":void 0,height:tt[1]?tt[1]+"px":void 0},Pe.type&&Object.assign({position:"absolute",top:r+"px",left:n+"px"},!tt[0]&&1===rt[0]&&{transform:"translateX(-50%)"})),s=P?e.createElement(e.Suspense,{fallback:q},o):o;return e.createElement("div",Object.assign({key:t},Pe.type||D?{[O]:""+t}:{},{className:"ms-object-box",style:l,onClick:Nt}),s)}),[P,!!q,tt.join(),xe,je,rt[0],Nt,Pe.type]),Xt=e.useMemo((()=>[{positionType:"x"===a?"left":"top",visibility:at},{positionType:"x"===a?"right":"bottom",visibility:ut},..."hybrid"===a?[{positionType:"left",visibility:dt},{positionType:"right",visibility:mt}]:[]]),[at,ut,a,dt,mt]),$t=e.useMemo((()=>({width:_e[2]+"px",height:_e[3]+"px"})),[_e]),Dt=e.useMemo((()=>[{shouldRender:pt({withLimit:!1})<Ue,direction:a,thumbSize:pt({}),thumbSpace:Ft,objLengthPerSize:Et,progressReverseIndex:0},{shouldRender:"hybrid"===a&&pt({withLimit:!1,xSize:!0})<Qe[0],direction:"x",thumbSize:pt({xSize:!0}),thumbSpace:Ht,objLengthPerSize:xt[0],progressReverseIndex:1}].filter((({shouldRender:e})=>e))),[pt,Ze,a,Qe[0],Ft,Ht,Et,xt]),Pt=e.useMemo((()=>{const e={position:"relative",width:_e[0]+"px",height:_e[1]+"px"};return H.arrows&&Ce.contentReduce&&Ce.size&&("x"===a?e.left=Ce.size+"px":"y"===a?e.top=Ce.size+"px":(e.top=Ce.size+"px",e.left=Ce.size+"px")),e}),[_e,ke,Ce,a]),qt=e.useMemo((()=>{var e;return null!==(e={x:st>_e[0]?"scroll hidden":"hidden",y:lt>_e[1]?"hidden scroll":"hidden",hybrid:`${st>_e[0]?"scroll":"hidden"} ${lt>_e[1]?"scroll":"hidden"}`,hide:"hidden"}[H.wheel||H.content?a:"hide"])&&void 0!==e?e:"hidden"}),[st,lt,_e,ke,a]),Kt=e.useMemo((()=>F?Xt.map((({positionType:t,visibility:r})=>e.createElement(c,{key:"edge-"+t,edgeGradient:Te,visibility:r,edgeType:t}))):null),[F,Xt,Te]),Vt=e.useMemo((()=>H.arrows?Xt.map((({positionType:t,visibility:r})=>e.createElement(u,{key:"arrow-"+t,activity:r,arrows:Ce,arrowType:t,handleArrow:zt,size:"hybrid"===a?_e[0]+2*Ce.size:_e[0]}))):null),[H.arrows,Xt,Ce,zt,_e[0],a,ue.current]),_t=e.useMemo((()=>H.progressElement&&!0!==H.progressElement?Dt.map((t=>{const r="boolean"==typeof I?I:I[t.progressReverseIndex];return e.createElement(s,{key:t.direction+"",type:i,direction:t.direction,progressReverse:r,size:Qe,progressTrigger:H,scrollBarOnHover:B,scrollBarEvent:"sliderMenu"===i?Rt:Lt,thumbSize:t.thumbSize,thumbSpace:t.thumbSpace,objLengthPerSize:t.objLengthPerSize,sliderCheckLocal:Tt,duration:Le.duration})})):null),[H.progressElement,Dt,i,I,Qe,H,B,Rt,Lt,Tt,Le.duration]),Ut=e.createElement("div",{className:"ms-objects-wrapper",ref:ne,style:kt},We.map(((t,r)=>{var o,s,i;const c=e.Children.toArray(l).find((r=>e.isValidElement(r)&&r.key===t)),u=Pe.stopLoadOnScroll&&ue.current&&!ce.current.loaded.includes(""+t)?q:(null===(o=ce.current.empty)||void 0===o?void 0:o.includes(t))?"object"==typeof(null==D?void 0:D.mode)?D.mode.fallback:q:c,d="number"==typeof et[0]&&"number"==typeof et[1]||"firstChild"!==et[0]&&"firstChild"!==et[1]||0!==r?u:e.createElement(n,{onResize:St},u);if(!Pe.type)return Yt(t,0,0,d);{const{elementTop:e,elementBottom:n,left:o,right:l}=bt[r],c="x"===a?Ke:Ve,u=Ue+c>("x"===a?o:e)-ct&&("x"===a?l:n)-ct>0-c,m="hybrid"!==a||_e[0]+Ke>o-((null===(s=re.current)||void 0===s?void 0:s.scrollLeft)||0)&&l-((null===(i=re.current)||void 0===i?void 0:i.scrollLeft)||0)>0-Ke;if(u&&m)return Yt(t,e,o,d)}}))),Gt=e.createElement("div",{"morph-scroll":`〈♦${J}〉`,className:r,ref:ee,style:$t},e.createElement("div",{className:"ms-content",ref:te,onMouseEnter:Ot,onMouseLeave:Ot,onTouchStart:Ot,onTouchEnd:Ot,style:Pt},e.createElement("div",{className:"ms-element",ref:re,onScroll:Wt,onKeyDown:It,onKeyUp:Bt,style:Object.assign(Object.assign(Object.assign({width:"100%",height:"100%",outline:"none"},vt),{overflow:qt}),"scroll"!==i||"boolean"!=typeof H.progressElement||!1===H.progressElement?{scrollbarWidth:"none"}:{})},tt[0]&&tt[1]?Ut:e.createElement(n,{onResize:jt,style:vt},Ut)),Kt,_t),Vt);return"auto"===h?e.createElement(n,{measure:"outer",onResize:wt},Gt):Gt};z.displayName="MorphScroll";const T={MorphScroll:z,ResizeTracker:n,IntersectionTracker:r};exports.IntersectionTracker=r,exports.MorphScroll=z,exports.ResizeTracker=n,exports.default=T;
